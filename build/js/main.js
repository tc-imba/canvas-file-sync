!function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="build/",t(t.s=13)}([function(e,t){e.exports=vendor_stable},function(e,t,r){e.exports=r(0)(5)},function(e,t,r){"use strict";var i={mp3:"audio",wma:"audio",wav:"audio",aac:"audio",mid:"audio",c:"code",h:"code",cpp:"code",cc:"code",hpp:"code",py:"code",html:"code",htm:"code",js:"code",css:"code",php:"code",jsp:"code",asp:"code",aspx:"code",java:"code",json:"code",yaml:"code",xml:"code",sql:"code",m:"code",mm:"code",lua:"code",rb:"code",as:"code",xls:"excel",xlsx:"excel",csv:"excel",slk:"excel",ods:"excel",bmp:"image",png:"image",jpg:"image",jpeg:"image",gif:"image",tiff:"image",mp4:"movie",mpeg:"movie",avi:"movie",mov:"movie",wmv:"movie",mkv:"movie",flv:"movie",rmvb:"movie","3gp":"movie",pdf:"pdf",ppt:"powerpoint",pps:"powerpoint",pptx:"powerpoint",ppsx:"powerpoint",odp:"powerpoint",txt:"text",md:"text",rst:"text",doc:"word",docx:"word",rtf:"word",odt:"word",rar:"zip",zip:"zip",iso:"zip","7z":"zip",tar:"zip",xz:"zip",gz:"zip",bz2:"zip"};e.exports={getIcon:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.hasOwnProperty(e)?"fa-file-"+i[e]+"-o":"fa-file-o"},processFile:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=t.match(/\.[\w]+$/);return r&&r.length>0?e.exports.getIcon(r[0].replace(".","")):e.exports.getIcon()},processArray:function(t){for(var r=0;r<t.length;r++)t[r].icon=e.exports.processFile(t[r].name)}}},function(e,t,r){"use strict";(function(t){/**
 * filesize
 *
 * @copyright 2017 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 3.5.9
 */
!function(t){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],a=0,o=void 0,l=void 0,d=void 0,c=void 0,h=void 0,u=void 0,p=void 0,f=void 0,_=void 0,g=void 0,m=void 0,v=void 0,y=void 0,j=void 0;if(isNaN(e))throw new Error("Invalid arguments");return d=!0===t.bits,m=!0===t.unix,l=t.base||2,g=void 0!==t.round?t.round:m?1:2,v=void 0!==t.spacer?t.spacer:m?"":" ",j=t.symbols||t.suffixes||{},y=2===l?t.standard||"jedec":"jedec",_=t.output||"string",h=!0===t.fullform,u=t.fullforms instanceof Array?t.fullforms:[],o=void 0!==t.exponent?t.exponent:-1,f=Number(e),p=f<0,c=l>2?1e3:1024,p&&(f=-f),(-1===o||isNaN(o))&&(o=Math.floor(Math.log(f)/Math.log(c)))<0&&(o=0),o>8&&(o=8),0===f?(r[0]=0,r[1]=m?"":n[y][d?"bits":"bytes"][o]):(a=f/(2===l?Math.pow(2,10*o):Math.pow(1e3,o)),d&&(a*=8)>=c&&o<8&&(a/=c,o++),r[0]=Number(a.toFixed(o>0?g:0)),r[1]=10===l&&1===o?d?"kb":"kB":n[y][d?"bits":"bytes"][o],m&&(r[1]="jedec"===y?r[1].charAt(0):o>0?r[1].replace(/B$/,""):r[1],i.test(r[1])&&(r[0]=Math.floor(r[0]),r[1]=""))),p&&(r[0]=-r[0]),r[1]=j[r[1]]||r[1],"array"===_?r:"exponent"===_?o:"object"===_?{value:r[0],suffix:r[1],symbol:r[1]}:(h&&(r[1]=u[o]?u[o]:s[y][o]+(d?"bit":"byte")+(1===r[0]?"":"s")),r.join(v))}var i=/^(b|B)$/,n={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},s={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};r.partial=function(e){return function(t){return r(t,e)}},e.exports=r}("undefined"!=typeof window&&window)}).call(t,r(14))},function(e,t,r){"use strict";var i,n,s,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(a){n=[r(1)],i=a,void 0!==(s="function"==typeof i?i.apply(t,n):i)&&(e.exports=s)}(function(e,t){/*!
  * jsTree 3.3.4
  * http://jstree.com/
  *
  * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
  *
  * Licensed same as jquery - under the terms of the MIT License
  *   http://www.opensource.org/licenses/mit-license.php
  */
/*!
  * if using jslint please allow for the jQuery global and use following options:
  * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
  */
if(!e.jstree){var r=0,i=!1,n=!1,s=!1,o=[],l=e("script:last").attr("src"),d=window.document;e.jstree={version:"3.3.4",defaults:{plugins:[]},plugins:{},path:l&&-1!==l.indexOf("/")?l.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var n=new e.jstree.core(++r),s=i;return i=e.extend(!0,{},e.jstree.defaults,i),s&&s.plugins&&(i.plugins=s.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(n=n.plugin(t,i[t]))}),e(t).data("jstree",n),n.init(t,i),n},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(d).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var r=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=e(t)}catch(e){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t])return r=i,!1}),r},e.fn.jstree=function(r){var i="string"==typeof r,n=Array.prototype.slice.call(arguments,1),s=null;return!(!0===r&&!this.length)&&(this.each(function(){var a=e.jstree.reference(this),o=i&&a?a[r]:null;if(s=i&&o?o.apply(a,n):null,a||i||r!==t&&!e.isPlainObject(r)||e.jstree.create(this,r),(a&&!i||!0===r)&&(s=a||!1),null!==s&&s!==t)return!1}),null!==s&&s!==t?s:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(r){return function(r){return e(r).hasClass("jstree")&&e(r).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,r){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(r,this)):this},init:function(t,r){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=r,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,r=d.createElement("LI");return r.setAttribute("role","treeitem"),e=d.createElement("I"),e.className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),r.appendChild(e),e=d.createElement("A"),e.className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),t=d.createElement("I"),t.className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),r.appendChild(e),e=t=null,r},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",r=null,i=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(d.selection&&d.selection.empty)d.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),i=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==d.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var r=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(r=this.get_parent(t.currentTarget))&&r.id!==e.jstree.root&&this.get_node(r,!0).children(".jstree-anchor").focus();break;case 38:t.preventDefault(),r=this.get_prev_dom(t.currentTarget),r&&r.length&&r.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(r=this.get_node(t.currentTarget,!0).children(".jstree-children")[0])&&e(this._firstChild(r)).children(".jstree-anchor").focus();break;case 40:t.preventDefault(),r=this.get_next_dom(t.currentTarget),r&&r.length&&r.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),r=this._firstChild(this.get_container_ul()[0]),r&&e(r).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:t.preventDefault(),this.edit(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,r){r.status&&(r.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,r,i=[];for(t=0,r=this._data.core.selected.length;t<r;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(i=e.vakata.array_unique(i),t=0,r=i.length;t<r;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;r&&clearTimeout(r),r=setTimeout(function(){t=""},500);var n=String.fromCharCode(i.which).toLowerCase(),s=this.element.find(".jstree-anchor").filter(":visible"),a=s.index(d.activeElement)||0,o=!1;if(t+=n,t.length>1){if(s.slice(a).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return;if(s.slice(0,a).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return}if(new RegExp("^"+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(s.slice(a+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).focus(),o=!0,!1},this)),o)return;if(s.slice(0,a+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).focus(),o=!0,!1},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var r=this.get_node(t.currentTarget);r&&r.id&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-i>500&&!this._data.core.focused){i=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(d).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var r=this.settings.core.strings;return e.isFunction(r)?r.call(this,t):r&&r[t]?r[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,r){t&&t.id&&(t=t.id);var i;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=e(t,this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=e(t,this.element)).length||!i.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return r&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,r,i){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var n,s,a=[];for(a.push(i?t.id:t.text),n=0,s=t.parents.length;n<s;n++)a.push(i?t.parents[n]:this.get_text(t.parents[n]));return a=a.reverse().slice(1),r?a.join(r):a},get_next_dom:function(t,r){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}if(t.hasClass("jstree-open")){for(i=this._firstChild(t.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return e(i)}i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return null!==i?e(i):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,r){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);if(null!==i){for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return!(!(i=t[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&e(i)},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||e.children.length>0)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,r){var i,n,s,a,o;if(e.isArray(t))return this._load_nodes(t.slice(),r),!0;if(!(t=this.get_node(t)))return r&&r.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,s=0,a=t.parents.length;s<a;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_filter(this._model.data[t.parents[s]].children_d,function(r){return-1===e.inArray(r,t.children_d)});for(i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.selected&&(o=!0),delete this._model.data[t.children_d[i]];o&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(r){return-1===e.inArray(r,t.children_d)})),t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var i=this.get_node(t,!0),n=0,s=0,a=this._model.data,o=!1;for(n=0,s=t.children.length;n<s;n++)if(a[t.children[n]]&&!a[t.children[n]].state.hidden){o=!0;break}t.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),o?"#"!==t.id&&i.addClass(t.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),r&&r.call(this,t,e)},this)),!0},_load_nodes:function(e,t,r,i){var n,s,a=!0,o=function(){this._load_nodes(e,t,!0)},l=this._model.data,d=[];for(n=0,s=e.length;n<s;n++)l[e[n]]&&(!l[e[n]].state.loaded&&!l[e[n]].state.failed||!r&&i)&&(this.is_loading(e[n])||this.load_node(e[n],o),a=!1);if(a){for(n=0,s=e.length;n<s;n++)l[e[n]]&&l[e[n]].state.loaded&&d.push(e[n]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,n,s=[],a=this._model.data,o=a[t.id].children_d;for(t.state&&!t.state.loaded&&s.push(t.id),i=0,n=o.length;i<n;i++)a[o[i]]&&a[o[i]].state&&!a[o[i]].state.loaded&&s.push(o[i]);s.length?this._load_nodes(s,function(){this.load_all(t,r)}):(r&&r.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,r){var i,n=this.settings.core.data,s=function(){return 3!==this.nodeType&&8!==this.nodeType};return n?e.isFunction(n)?n.call(this,t,e.proxy(function(i){!1===i?r.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(e.parseHTML(i)).filter(s):i,function(e){r.call(this,e)})},this)):"object"===(void 0===n?"undefined":a(n))?n.url?(n=e.extend(!0,{},n),e.isFunction(n.url)&&(n.url=n.url.call(this,t)),e.isFunction(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(e.proxy(function(i,n,o){var l=o.getResponseHeader("Content-Type");return l&&-1!==l.indexOf("json")||"object"===(void 0===i?"undefined":a(i))?this._append_json_data(t,i,function(e){r.call(this,e)}):l&&-1!==l.indexOf("html")||"string"==typeof i?this._append_html_data(t,e(e.parseHTML(i)).filter(s),function(e){r.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:o})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))},this)).fail(e.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},r.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=e.isArray(n)?e.extend(!0,[],n):e.isPlainObject(n)?e.extend(!0,{},n):n,t.id===e.jstree.root?this._append_json_data(t,i,function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))):"string"==typeof n?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(n)).filter(s),function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1)):r.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){r.call(this,e)}):r.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&this._model.changed.push(e.id)},_append_html_data:function(t,r,i){t=this.get_node(t),t.children=[],t.children_d=[];var n,s,a,o=r.is("ul")?r.children():r,l=t.id,d=[],c=[],h=this._model.data,u=h[l],p=this._data.core.selected.length;for(o.each(e.proxy(function(t,r){(n=this._parse_model_from_html(e(r),l,u.parents.concat()))&&(d.push(n),c.push(n),h[n].children_d.length&&(c=c.concat(h[n].children_d)))},this)),u.children=d,u.children_d=c,s=0,a=u.parents.length;s<a;s++)h[u.parents[s]].children_d=h[u.parents[s]].children_d.concat(c);this.trigger("model",{nodes:c,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==p&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,r,i,n){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],r.d&&"string"==typeof(r=r.d)&&(r=JSON.parse(r)),e.isArray(r)||(r=[r]);var s=null,o={df:this._model.default_state,dat:r,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},l=function(e,t){e.data&&(e=e.data);var r,i,n,s,o=e.dat,l=e.par,d=[],c=[],h=[],u=e.df,p=e.t_id,f=e.t_cnt,_=e.m,g=_[l],m=e.sel;if(o.length&&o[0].id!==t&&o[0].parent!==t){for(i=0,n=o.length;i<n;i++)o[i].children||(o[i].children=[]),_[o[i].id.toString()]=o[i];for(i=0,n=o.length;i<n;i++)_[o[i].parent.toString()].children.push(o[i].id.toString()),g.children_d.push(o[i].id.toString());for(i=0,n=g.children.length;i<n;i++)r=function e(r,i,n){n=n?n.concat():[],i&&n.unshift(i);var s,o,l,d,c=r.id.toString(),p={id:c,text:r.text||"",icon:r.icon===t||r.icon,parent:i,parents:n,children:r.children||[],children_d:r.children_d||[],data:r.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in u)u.hasOwnProperty(s)&&(p.state[s]=u[s]);if(r&&r.data&&r.data.jstree&&r.data.jstree.icon&&(p.icon=r.data.jstree.icon),p.icon!==t&&null!==p.icon&&""!==p.icon||(p.icon=!0),r&&r.data&&(p.data=r.data,r.data.jstree))for(s in r.data.jstree)r.data.jstree.hasOwnProperty(s)&&(p.state[s]=r.data.jstree[s]);if(r&&"object"===a(r.state))for(s in r.state)r.state.hasOwnProperty(s)&&(p.state[s]=r.state[s]);if(r&&"object"===a(r.li_attr))for(s in r.li_attr)r.li_attr.hasOwnProperty(s)&&(p.li_attr[s]=r.li_attr[s]);if(p.li_attr.id||(p.li_attr.id=c),r&&"object"===a(r.a_attr))for(s in r.a_attr)r.a_attr.hasOwnProperty(s)&&(p.a_attr[s]=r.a_attr[s]);for(r&&r.children&&!0===r.children&&(p.state.loaded=!1,p.children=[],p.children_d=[]),_[p.id]=p,s=0,o=p.children.length;s<o;s++)l=e(_[p.children[s]],p.id,n),d=_[l],p.children_d.push(l),d.children_d.length&&(p.children_d=p.children_d.concat(d.children_d));return delete r.data,delete r.children,_[p.id].original=r,p.state.selected&&h.push(p.id),p.id}(_[g.children[i]],l,g.parents.concat()),c.push(r),_[r].children_d.length&&(c=c.concat(_[r].children_d));for(i=0,n=g.parents.length;i<n;i++)_[g.parents[i]].children_d=_[g.parents[i]].children_d.concat(c);s={cnt:f,mod:_,sel:m,par:l,dpc:c,add:h}}else{for(i=0,n=o.length;i<n;i++)(r=function e(r,i,n){n=n?n.concat():[],i&&n.unshift(i);var s,o,l,d,c,g=!1;do{g="j"+p+"_"+ ++f}while(_[g]);c={id:!1,text:"string"==typeof r?r:"",icon:"object"!==(void 0===r?"undefined":a(r))||r.icon===t||r.icon,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in u)u.hasOwnProperty(s)&&(c.state[s]=u[s]);if(r&&r.id&&(c.id=r.id.toString()),r&&r.text&&(c.text=r.text),r&&r.data&&r.data.jstree&&r.data.jstree.icon&&(c.icon=r.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),r&&r.data&&(c.data=r.data,r.data.jstree))for(s in r.data.jstree)r.data.jstree.hasOwnProperty(s)&&(c.state[s]=r.data.jstree[s]);if(r&&"object"===a(r.state))for(s in r.state)r.state.hasOwnProperty(s)&&(c.state[s]=r.state[s]);if(r&&"object"===a(r.li_attr))for(s in r.li_attr)r.li_attr.hasOwnProperty(s)&&(c.li_attr[s]=r.li_attr[s]);if(c.li_attr.id&&!c.id&&(c.id=c.li_attr.id.toString()),c.id||(c.id=g),c.li_attr.id||(c.li_attr.id=c.id),r&&"object"===a(r.a_attr))for(s in r.a_attr)r.a_attr.hasOwnProperty(s)&&(c.a_attr[s]=r.a_attr[s]);if(r&&r.children&&r.children.length){for(s=0,o=r.children.length;s<o;s++)l=e(r.children[s],c.id,n),d=_[l],c.children.push(l),d.children_d.length&&(c.children_d=c.children_d.concat(d.children_d));c.children_d=c.children_d.concat(c.children)}return r&&r.children&&!0===r.children&&(c.state.loaded=!1,c.children=[],c.children_d=[]),delete r.data,delete r.children,c.original=r,_[c.id]=c,c.state.selected&&h.push(c.id),c.id}(o[i],l,g.parents.concat()))&&(d.push(r),c.push(r),_[r].children_d.length&&(c=c.concat(_[r].children_d)));for(g.children=d,g.children_d=c,i=0,n=g.parents.length;i<n;i++)_[g.parents[i]].children_d=_[g.parents[i]].children_d.concat(c);s={cnt:f,mod:_,sel:m,par:l,dpc:c,add:h}}if("undefined"!=typeof window&&void 0!==window.document)return s;postMessage(s)},d=function(t,r){if(null!==this.element){this._cnt=t.cnt;var n,s=this._model.data;for(n in s)s.hasOwnProperty(n)&&s[n].state&&s[n].state.loading&&t.mod[n]&&(t.mod[n].state.loading=!0);if(this._model.data=t.mod,r){var a,o=t.add,l=t.sel,d=this._data.core.selected.slice();if(s=this._model.data,l.length!==d.length||e.vakata.array_unique(l.concat(d)).length!==l.length){for(n=0,a=l.length;n<a;n++)-1===e.inArray(l[n],o)&&-1===e.inArray(l[n],d)&&(s[l[n]].state.selected=!1);for(n=0,a=d.length;n<a;n++)-1===e.inArray(d[n],l)&&(s[d[n]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+l.toString()],{type:"text/javascript"}))),!this._data.core.working||n?(this._data.core.working=!0,s=new window.Worker(this._wrk),s.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{s.terminate(),s=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),o.par?s.postMessage(o):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,r,i,!0])}catch(e){d.call(this,l(o),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,l(o),!1)}},_parse_model_from_html:function(r,i,n){n=n?[].concat(n):[],i&&n.unshift(i);var s,a,o,l,d,c=this._model.data,h={id:!1,text:!1,icon:!0,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(l=e.vakata.attributes(r,!0),e.each(l,function(t,r){if(r=e.trim(r),!r.length)return!0;h.li_attr[t]=r,"id"===t&&(h.id=r.toString())}),l=r.children("a").first(),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,r){r=e.trim(r),r.length&&(h.a_attr[t]=r)})),l=r.children("a").first().length?r.children("a").first().clone():r.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),h.text=this.settings.core.force_text?l.text():l.html(),l=r.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=r.hasClass("jstree-open"),h.state.selected=r.children("a").hasClass("jstree-clicked"),h.state.disabled=r.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);l=r.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),l=r.children("ul").children("li");do{d="j"+this._id+"_"+ ++this._cnt}while(c[d]);return h.id=h.li_attr.id?h.li_attr.id.toString():d,l.length?(l.each(e.proxy(function(t,r){s=this._parse_model_from_html(e(r),h.id,n),a=this._model.data[s],h.children.push(s),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):r.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr.class&&(h.li_attr.class=h.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),h.a_attr.class&&(h.a_attr.class=h.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),c[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,o,l,d=e.id.toString(),c=this._model.data,h=this._model.default_state,u={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in h)h.hasOwnProperty(n)&&(u.state[n]=h[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(u.icon=e.data.jstree.icon),u.icon!==t&&null!==u.icon&&""!==u.icon||(u.icon=!0),e&&e.data&&(u.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(u.state[n]=e.data.jstree[n]);if(e&&"object"===a(e.state))for(n in e.state)e.state.hasOwnProperty(n)&&(u.state[n]=e.state[n]);if(e&&"object"===a(e.li_attr))for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(u.li_attr[n]=e.li_attr[n]);if(u.li_attr.id||(u.li_attr.id=d),e&&"object"===a(e.a_attr))for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(u.a_attr[n]=e.a_attr[n]);for(e&&e.children&&!0===e.children&&(u.state.loaded=!1,u.children=[],u.children_d=[]),c[u.id]=u,n=0,s=u.children.length;n<s;n++)o=this._parse_model_from_flat_json(c[u.children[n]],u.id,i),l=c[o],u.children_d.push(o),l.children_d.length&&(u.children_d=u.children_d.concat(l.children_d));return delete e.data,delete e.children,c[u.id].original=e,u.state.selected&&this._data.core.selected.push(u.id),u.id},_parse_model_from_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,o,l,d,c=!1,h=this._model.data,u=this._model.default_state;do{c="j"+this._id+"_"+ ++this._cnt}while(h[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!==(void 0===e?"undefined":a(e))||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in u)u.hasOwnProperty(n)&&(d.state[n]=u[n]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(d.state[n]=e.data.jstree[n]);if(e&&"object"===a(e.state))for(n in e.state)e.state.hasOwnProperty(n)&&(d.state[n]=e.state[n]);if(e&&"object"===a(e.li_attr))for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(d.li_attr[n]=e.li_attr[n]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"===a(e.a_attr))for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(d.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,s=e.children.length;n<s;n++)o=this._parse_model_from_json(e.children[n],d.id,i),l=h[o],d.children.push(o),l.children_d.length&&(d.children_d=d.children_d.concat(l.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,h[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,r,i,n=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),s=d.createElement("UL"),a=this._data.core.focused;for(r=0,i=n.length;r<i;r++)(t=this.redraw_node(n[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&s.appendChild(t);this._model.force_full_redraw&&(s.className=this.get_container_ul()[0].className,s.setAttribute("role","group"),this.element.empty().append(s)),null!==a&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==d.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:n})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var r=this.get_node(t),i=!1,n=!1,s=!1,a=d;if(!r)return!1;if(r.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for(s=a.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",i=0,n=r.children.length;i<n;i++)s.appendChild(this.redraw_node(r.children[i],!0,!0));t.appendChild(s)}},redraw_node:function(t,r,i,n){var s=this.get_node(t),a=!1,o=!1,l=!1,c=!1,h=!1,u=!1,p="",f=d,_=this._model.data,g=!1,m=null,v=0,y=0,j=!1,b=!1;if(!s)return!1;if(s.id===e.jstree.root)return this.redraw(!0);if(r=r||0===s.children.length,t=d.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(e.jstree.idregex,"\\$&"):s.id.replace(e.jstree.idregex,"\\$&"))):d.getElementById(s.id))t=e(t),i||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),o=t.index()),r||!s.children.length||t.children(".jstree-children").length||(r=!0),r||(l=t.children(".jstree-children")[0]),g=t.children(".jstree-anchor")[0]===d.activeElement,t.remove();else if(r=!0,!i){if(!(null===(a=s.parent!==e.jstree.root?e("#"+s.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||a&&_[s.parent].state.opened))return!1;o=e.inArray(s.id,null===a?_[e.jstree.root].children:_[s.parent].children)}t=this._data.core.node.cloneNode(!0),p="jstree-node ";for(c in s.li_attr)if(s.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,s.li_attr[c]):p+=s.li_attr[c]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),t.setAttribute("aria-selected",!!s.state.selected),t.setAttribute("aria-level",s.parents.length),t.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,h=s.children.length;c<h;c++)if(!_[s.children[c]].state.hidden){j=!0;break}if(null!==s.parent&&_[s.parent]&&!s.state.hidden&&(c=e.inArray(s.id,_[s.parent].children),b=s.id,-1!==c))for(c++,h=_[s.parent].children.length;c<h&&(_[_[s.parent].children[c]].state.hidden||(b=_[s.parent].children[c]),b===s.id);c++);s.state.hidden&&(p+=" jstree-hidden"),s.state.loaded&&!j?p+=" jstree-leaf":(p+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),b===s.id&&(p+=" jstree-last"),t.id=s.id,t.className=p,p=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(h in s.a_attr)if(s.a_attr.hasOwnProperty(h)){if("href"===h&&"#"===s.a_attr[h])continue;"class"!==h?t.childNodes[1].setAttribute(h,s.a_attr[h]):p+=" "+s.a_attr[h]}if(p.length&&(t.childNodes[1].className="jstree-anchor "+p),(s.icon&&!0!==s.icon||!1===s.icon)&&(!1===s.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(f.createTextNode(s.text)):t.childNodes[1].innerHTML+=s.text,r&&s.children.length&&(s.state.opened||n)&&s.state.loaded){for(u=f.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,h=s.children.length;c<h;c++)u.appendChild(this.redraw_node(s.children[c],r,!0));t.appendChild(u)}if(l&&t.appendChild(l),!i){for(a||(a=this.element[0]),c=0,h=a.childNodes.length;c<h;c++)if(a.childNodes[c]&&a.childNodes[c].className&&-1!==a.childNodes[c].className.indexOf("jstree-children")){m=a.childNodes[c];break}m||(m=f.createElement("UL"),m.setAttribute("role","group"),m.className="jstree-children",a.appendChild(m)),a=m,o<a.childNodes.length?a.insertBefore(t,a.childNodes[o]):a.appendChild(t),g&&(v=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=v,this.element[0].scrollLeft=y)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(s.id,!1,0)},this),0)),t},open_node:function(r,i,n){var s,a,o,l;if(e.isArray(r)){for(r=r.slice(),s=0,a=r.length;s<a;s++)this.open_node(r[s],i,n);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(n=n===t?this.settings.core.animation:n,this.is_closed(r)?this.is_loaded(r)?(o=this.get_node(r,!0),l=this,o.length&&(n&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),r.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(r),n?(this.trigger("before_open",{node:r}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(n,function(){this.style.display="",l.element&&l.trigger("after_open",{node:r})})):(this.trigger("before_open",{node:r}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),r.state.opened=!0,i&&i.call(this,r,!0),o.length||this.trigger("before_open",{node:r}),this.trigger("open_node",{node:r}),n&&o.length||this.trigger("after_open",{node:r}),!0):this.is_loading(r)?setTimeout(e.proxy(function(){this.open_node(r,i,n)},this),500):void this.load_node(r,function(e,t){return t?this.open_node(e,i,n):!!i&&i.call(this,e,!1)}):(i&&i.call(this,r,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r,i,n=t.parents;for(r=0,i=n.length;r<i;r+=1)r!==e.jstree.root&&this.open_node(n[r],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(r,i){var n,s,a,o;if(e.isArray(r)){for(r=r.slice(),n=0,s=r.length;n<s;n++)this.close_node(r[n],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(!this.is_closed(r)&&(i=i===t?this.settings.core.animation:i,a=this,o=this.get_node(r,!0),r.state.opened=!1,this.trigger("close_node",{node:r}),void(o.length?i?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",o.children(".jstree-children").remove(),a.element&&a.trigger("after_close",{node:r})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:r})):this.trigger("after_close",{node:r}))))},toggle_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.toggle_node(t[r]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,r,i){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var n,s,a,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(n=0,s=t.children_d.length;n<s;n++)this.is_closed(this._model.data[t.children_d[n]])&&(this._model.data[t.children_d[n]].state.opened=!0);return this.trigger("open_all",{node:t})}i=i||o,a=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,i)},r||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(t,r){if(t||(t=e.jstree.root),!(t=this.get_node(t)))return!1;var i,n,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(s.length&&(s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){a.close_node(this,r||0)})),i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.enable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:t})},disable_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.disable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:t})},is_hidden:function(e){return e=this.get_node(e),!0===e.state.hidden},hide_node:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.hide_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),r||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.show_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),r||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&!i[r].state.hidden&&(i[r].state.hidden=!0,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:n}),n},show_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&i[r].state.hidden&&(i[r].state.hidden=!1,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:n}),n},activate_node:function(e,r){if(this.is_disabled(e))return!1;if(r&&"object"===(void 0===r?"undefined":a(r))||(r={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&(!r.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(r.shiftKey){var i,n,s=this.get_node(e).id,o=this._data.core.last_clicked.id,l=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(i=0,n=l.length;i<n;i+=1)l[i]===s&&(d=!d),l[i]===o&&(d=!d),this.is_disabled(l[i])||!d&&l[i]!==s&&l[i]!==o?this.deselect_node(l[i],!0,r):this.is_hidden(l[i])||this.select_node(l[i],!0,!1,r);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:r})}else this.is_selected(e)?this.deselect_node(e,!1,r):this.select_node(e,!1,!1,r);else!this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,r):(this.deselect_all(!0),this.select_node(e,!1,!1,r),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:r})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,r,i,n){var s,a,o;if(e.isArray(t)){for(t=t.slice(),a=0,o=t.length;a<o;a++)this.select_node(t[a],r,i,n);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;s=this.get_node(t,!0),t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),i||(s=this._open_to(t)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:n}),r||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:n}))},deselect_node:function(t,r,i){var n,s,a;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;n<s;n++)this.deselect_node(t[n],r,i);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i}))},select_all:function(t){var r,i,n=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),r=0,i=this._data.core.selected.length;r<i;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:n})},deselect_all:function(e){var t,r,i=this._data.core.selected.concat([]);for(t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var r,i,n,s,a=this.get_selected(!0),o={};for(r=0,i=a.length;r<i;r++)o[a[r].id]=a[r];for(r=0,i=a.length;r<i;r++)for(n=0,s=a[r].children_d.length;n<s;n++)o[a[r].children_d[n]]&&delete o[a[r].children_d[n]];a=[];for(r in o)o.hasOwnProperty(r)&&a.push(r);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var r,i,n=this.get_selected(!0),s=[];for(r=0,i=n.length;r<i;r++)n[r].children.length||s.push(n[r].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_state:function(){var t,r={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},/*!
     'themes' : {
     	'name' : this.get_theme(),
     	'icons' : this._data.core.themes.icons,
     	'dots' : this._data.core.themes.dots
     },
     */
selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&r.core.open.push(t),this._model.data[t].state.selected&&r.core.selected.push(t));return r},set_state:function(r,i){if(r){if(r.core&&r.core.selected&&r.core.initial_selection===t&&(r.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),r.core){var n,s;if(r.core.open)return e.isArray(r.core.open)&&r.core.open.length?this._load_nodes(r.core.open,function(e){this.open_node(e,!1,0),delete r.core.open,this.set_state(r,i)}):(delete r.core.open,this.set_state(r,i)),!1;if(r.core.scroll)return r.core.scroll&&r.core.scroll.left!==t&&this.element.scrollLeft(r.core.scroll.left),r.core.scroll&&r.core.scroll.top!==t&&this.element.scrollTop(r.core.scroll.top),delete r.core.scroll,this.set_state(r,i),!1;if(r.core.selected)return n=this,r.core.initial_selection!==t&&r.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),e.each(r.core.selected,function(e,t){n.select_node(t,!1,!0)})),delete r.core.initial_selection,delete r.core.selected,this.set_state(r,i),!1;for(s in r)r.hasOwnProperty(s)&&"core"!==s&&-1===e.inArray(s,this.settings.plugins)&&delete r[s];if(e.isEmptyObject(r.core))return delete r.core,this.set_state(r,i),!1}return!e.isEmptyObject(r)||(r=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,r){this._data.core.state=!0===r?{}:this.get_state(),r&&e.isFunction(r)&&(this._data.core.state=r.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,r){r&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r=[],i=[],n=this._data.core.selected.concat([]);i.push(t.id),!0===t.state.opened&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id),r.push(this.id)}),this._load_nodes(i,e.proxy(function(e){this.open_node(r,!1,0),this.select_node(n),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,r){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i,n,s=this._model.data,a=t.id;for(r=r.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=r,i=0,n=t.parents.length;i<n;i++)s[t.parents[i]].children_d[e.inArray(t.id,s[t.parents[i]].children_d)]=r;for(i=0,n=t.children.length;i<n;i++)s[t.children[i]].parent=r;for(i=0,n=t.children_d.length;i<n;i++)s[t.children_d[i]].parents[e.inArray(t.id,s[t.children_d[i]].parents)]=r;return i=e.inArray(t.id,this._data.core.selected),-1!==i&&(this._data.core.selected[i]=r),i=this.get_node(t.id,!0),i&&(i.attr("id",r),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",r)),delete s[t.id],t.id=r,t.li_attr.id=r,s[r]=t,this.trigger("set_id",{node:t,new:t.id,old:a}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.set_text(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(t.text=r,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:r}),!0)},get_json:function(t,r,i){if(!(t=this.get_node(t||e.jstree.root)))return!1;r&&r.flat&&!i&&(i=[]);var n,s,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!r||!r.no_data)&&e.extend(!0,e.isArray(t.data)?[]:{},t.data)};if(r&&r.flat?a.parent=t.parent:a.children=[],r&&r.no_state)delete a.state;else for(n in t.state)t.state.hasOwnProperty(n)&&(a.state[n]=t.state[n]);if(r&&r.no_li_attr&&delete a.li_attr,r&&r.no_a_attr&&delete a.a_attr,r&&r.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),r&&r.flat&&t.id!==e.jstree.root&&i.push(a),!r||!r.no_children)for(n=0,s=t.children.length;n<s;n++)r&&r.flat?this.get_json(t.children[n],r,i):a.children.push(this.get_json(t.children[n],r));return r&&r.flat?i:t.id===e.jstree.root?a.children:a},create_node:function(r,i,n,s,a){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return!1;if(n=n===t?"last":n,!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.create_node(r,i,n,s,!0)});i||(i={text:this.get_string("New node")}),i="string"==typeof i?{text:i}:e.extend(!0,{},i),i.text===t&&(i.text=this.get_string("New node"));var o,l,d,c;switch(r.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":o=this.get_node(r.parent),n=e.inArray(r.id,o.children),r=o;break;case"after":o=this.get_node(r.parent),n=e.inArray(r.id,o.children)+1,r=o;break;case"inside":case"first":n=0;break;case"last":n=r.children.length;break;default:n||(n=0)}if(n>r.children.length&&(n=r.children.length),i.id||(i.id=!0),!this.check("create_node",i,r,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===i.id&&delete i.id,!(i=this._parse_model_from_json(i,r.id,r.parents.concat())))return!1;for(o=this.get_node(i),l=[],l.push(i),l=l.concat(o.children_d),this.trigger("model",{nodes:l,parent:r.id}),r.children_d=r.children_d.concat(l),d=0,c=r.parents.length;d<c;d++)this._model.data[r.parents[d]].children_d=this._model.data[r.parents[d]].children_d.concat(l);for(i=o,o=[],d=0,c=r.children.length;d<c;d++)o[d>=n?d+1:d]=r.children[d];return o[n]=i.id,r.children=o,this.redraw_node(r,!0),this.trigger("create_node",{node:this.get_node(i),parent:r.id,position:n}),s&&s.call(this,this.get_node(i)),i.id},rename_node:function(t,r){var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.rename_node(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&(s=t.text,this.check("rename_node",t,this.get_parent(t),r)?(this.set_text(t,r),this.trigger("rename_node",{node:t,text:r,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var r,i,n,s,a,o,l,d,c,h,u,p;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.delete_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(n=this.get_node(t.parent),s=e.inArray(t.id,n.children),h=!1,!this.check("delete_node",t,n,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(n.children=e.vakata.array_remove(n.children,s)),a=t.children_d.concat([]),a.push(t.id),o=0,l=t.parents.length;o<l;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(t){return-1===e.inArray(t,a)});for(d=0,c=a.length;d<c;d++)if(this._model.data[a[d]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,a)})),this.trigger("delete_node",{node:t,parent:n.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:n.id}),d=0,c=a.length;d<c;d++)delete this._model.data[a[d]];return-1!==e.inArray(this._data.core.focused,a)&&(this._data.core.focused=null,u=this.element[0].scrollTop,p=this.element[0].scrollLeft,n.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(n,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=p),this.redraw_node(n,!0),!0},check:function(t,r,i,n,s){r=r&&r.id?r:this.get_node(r),i=i&&i.id?i:this.get_node(i);var a=t.match(/^move_node|copy_node|create_node$/i)?i:r,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||r.id!==i.id&&("move_node"!==t||e.inArray(r.id,i.children)!==n)&&-1===e.inArray(i.id,r.children_d)?(a&&a.data&&(a=a.data),a&&a.functions&&(!1===a.functions[t]||!0===a.functions[t])?(!1===a.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),a.functions[t]):!(!1===o||e.isFunction(o)&&!1===o.call(this,t,r,i,n,s)||o&&!1===o[t])||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(r,i,n,s,a,o,l){var d,c,h,u,p,f,_,g,m,v,y,j,b,x;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(r,i,n,s,!0,!1,l)});if(e.isArray(r)){if(1!==r.length){for(d=0,c=r.length;d<c;d++)(m=this.move_node(r[d],i,n,s,a,!1,l))&&(i=m,n="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;if(h=(r.parent||e.jstree.root).toString(),p=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,f=l||(this._model.data[r.id]?this:e.jstree.reference(r.id)),_=!f||!f._id||this._id!==f._id,u=f&&f._id&&h&&f._model.data[h]&&f._model.data[h].children?e.inArray(r.id,f._model.data[h].children):-1,f&&f._id&&(r=f._model.data[r.id]),_)return!!(m=this.copy_node(r,i,n,s,a,!1,l))&&(f&&f.delete_node(r),m);switch(i.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,p.children);break;case"after":n=e.inArray(i.id,p.children)+1;break;case"inside":case"first":n=0;break;case"last":n=p.children.length;break;default:n||(n=0)}if(n>p.children.length&&(n=p.children.length),!this.check("move_node",r,p,n,{core:!0,origin:l,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.parent===p.id){for(g=p.children.concat(),m=e.inArray(r.id,g),-1!==m&&(g=e.vakata.array_remove(g,m),n>m&&n--),m=[],v=0,y=g.length;v<y;v++)m[v>=n?v+1:v]=g[v];m[n]=r.id,p.children=m,this._node_changed(p.id),this.redraw(p.id===e.jstree.root)}else{for(m=r.children_d.concat(),m.push(r.id),v=0,y=r.parents.length;v<y;v++){for(g=[],x=f._model.data[r.parents[v]].children_d,j=0,b=x.length;j<b;j++)-1===e.inArray(x[j],m)&&g.push(x[j]);f._model.data[r.parents[v]].children_d=g}for(f._model.data[h].children=e.vakata.array_remove_item(f._model.data[h].children,r.id),v=0,y=p.parents.length;v<y;v++)this._model.data[p.parents[v]].children_d=this._model.data[p.parents[v]].children_d.concat(m);for(g=[],v=0,y=p.children.length;v<y;v++)g[v>=n?v+1:v]=p.children[v];for(g[n]=r.id,p.children=g,p.children_d.push(r.id),p.children_d=p.children_d.concat(r.children_d),r.parent=p.id,m=p.parents.concat(),m.unshift(p.id),x=r.parents.length,r.parents=m,m=m.concat(),v=0,y=r.children_d.length;v<y;v++)this._model.data[r.children_d[v]].parents=this._model.data[r.children_d[v]].parents.slice(0,-1*x),Array.prototype.push.apply(this._model.data[r.children_d[v]].parents,m);h!==e.jstree.root&&p.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(p.id)),o||this.redraw()}return s&&s.call(this,r,p,n),this.trigger("move_node",{node:r,parent:p.id,position:n,old_parent:h,old_position:u,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id,old_instance:f,new_instance:this}),r.id},copy_node:function(r,i,n,s,a,o,l){var d,c,h,u,p,f,_,g,m,v;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(r,i,n,s,!0,!1,l)});if(e.isArray(r)){if(1!==r.length){for(d=0,c=r.length;d<c;d++)(u=this.copy_node(r[d],i,n,s,a,!0,l))&&(i=u,n="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id?r:this.get_node(r))||r.id===e.jstree.root)return!1;switch(g=(r.parent||e.jstree.root).toString(),m=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,v=l||(this._model.data[r.id]?this:e.jstree.reference(r.id)),!v||!v._id||this._id!==v._id,v&&v._id&&(r=v._model.data[r.id]),i.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,m.children);break;case"after":n=e.inArray(i.id,m.children)+1;break;case"inside":case"first":n=0;break;case"last":n=m.children.length;break;default:n||(n=0)}if(n>m.children.length&&(n=m.children.length),!this.check("copy_node",r,m,n,{core:!0,origin:l,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(_=v?v.get_json(r,{no_id:!0,no_data:!0,no_state:!0}):r))return!1;if(!0===_.id&&delete _.id,!(_=this._parse_model_from_json(_,m.id,m.parents.concat())))return!1;for(u=this.get_node(_),r&&r.state&&!1===r.state.loaded&&(u.state.loaded=!1),h=[],h.push(_),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:m.id}),p=0,f=m.parents.length;p<f;p++)this._model.data[m.parents[p]].children_d=this._model.data[m.parents[p]].children_d.concat(h);for(h=[],p=0,f=m.children.length;p<f;p++)h[p>=n?p+1:p]=m.children[p];return h[n]=u.id,m.children=h,m.children_d.push(u.id),m.children_d=m.children_d.concat(u.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),s&&s.call(this,u,m,n),this.trigger("copy_node",{node:u,original:r,parent:m.id,position:n,old_parent:g,old_position:v&&v._id&&g&&v._model.data[g]&&v._model.data[g].children?e.inArray(r.id,v._model.data[g].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,a,o,l=[];for(a=0,o=t.length;a<o;a++)(r=this.get_node(t[a]))&&r.id&&r.id!==e.jstree.root&&l.push(r);if(!l.length)return!1;i=l,s=this,n="move_node",this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,a,o,l=[];for(a=0,o=t.length;a<o;a++)(r=this.get_node(t[a]))&&r.id&&r.id!==e.jstree.root&&l.push(r);if(!l.length)return!1;i=l,s=this,n="copy_node",this.trigger("copy",{node:t})},get_buffer:function(){return{mode:n,node:i,inst:s}},can_paste:function(){return!1!==n&&!1!==i},paste:function(e,t){if(!((e=this.get_node(e))&&n&&n.match(/^(copy_node|move_node)$/)&&i))return!1;this[n](i,e,t,!1,!1,!1,s)&&this.trigger("paste",{parent:e.id,node:i,mode:n}),i=!1,n=!1,s=!1},clear_buffer:function(){i=!1,n=!1,s=!1,this.trigger("clear_buffer")},edit:function(t,r,i){var n,s,a,o,l,c,h,u,p,f=!1;/*!
   oi = obj.children("i:visible"),
   ai = a.children("i:visible"),
   w1 = oi.width() * oi.length,
   w2 = ai.width() * ai.length,
   */
return!!(t=this.get_node(t))&&(this.check("edit",t,this.get_parent(t))?(p=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),p.text=r,n=this._data.core.rtl,s=this.element.width(),this._data.core.focused=p.id,a=t.children(".jstree-anchor").focus(),o=e("<span>"),l=r,c=e("<div />",{css:{position:"absolute",top:"-200px",left:n?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=e("<input />",{value:l,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(r){r.stopImmediatePropagation(),r.preventDefault();var n,s=o.children(".jstree-rename-input"),d=s.val(),u=this.settings.core.force_text;""===d&&(d=l),c.remove(),o.replaceWith(a),o.remove(),l=u?l:e("<div></div>").append(e.parseHTML(l)).html(),this.set_text(t,l),n=!!this.rename_node(t,u?e("<div></div>").text(d).text():e("<div></div>").append(e.parseHTML(d)).html()),n||this.set_text(t,l),this._data.core.focused=p.id,setTimeout(e.proxy(function(){var e=this.get_node(p.id,!0);e.length&&(this._data.core.focused=p.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,p,n,f),h=null},this),keydown:function(e){var t=e.which;27===t&&(f=!0,this.value=l),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(c.text("pW"+this.value).width(),s))},keypress:function(e){if(13===e.which)return!1}}),u={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},o.attr("class",a.attr("class")).append(a.contents().clone()).append(h),a.replaceWith(o),c.css(u),h.css(u).width(Math.min(c.text("pW"+h[0].value).width(),s))[0].select(),void e(d).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(t,r){if(!t)return!1;if(!0===r){var i=this.settings.core.themes.dir;i||(i=e.jstree.path+"/themes"),r=i+"/"+t+"/style.css"}r&&-1===e.inArray(r,o)&&(e("head").append('<link rel="stylesheet" href="'+r+'" type="text/css" />'),o.push(r)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(r,i){var n,s,a,o;if(e.isArray(r)){for(r=r.slice(),n=0,s=r.length;n<s;n++)this.set_icon(r[n],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(o=r.icon,r.icon=!0===i||null===i||i===t||""===i||i,a=this.get_node(r,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===i?this.hide_icon(r):!0===i||null===i||i===t||""===i?(a.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),!1===o&&this.show_icon(r)):-1===i.indexOf("/")&&-1===i.indexOf(".")?(a.removeClass(o).css("background",""),a.addClass(i+" jstree-themeicon-custom").attr("rel",i),!1===o&&this.show_icon(r)):(a.removeClass(o).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),!1===o&&this.show_icon(r)),!0)},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.hide_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.show_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root)&&(n=this.get_node(t,!0),t.icon=!n.length||n.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),n.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,r){t=e(t)[0];var i=r?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,n){-1===e.inArray(n.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==n.value&&""!==e.trim(n.value)&&(r?i[n.name]=n.value:i.push(n.name))}),i},e.vakata.array_unique=function(e){var r,i,n=[],s={};for(r=0,i=e.length;r<i;r++)s[e[r]]===t&&(n.push(e[r]),s[e[r]]=!0);return n},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,r){var i=e.inArray(r,t);return-1!==i?e.vakata.array_remove(t,i):t},e.vakata.array_filter=function(e,t,r,i,n){if(e.filter)return e.filter(t,r);i=[];for(n in e)~~n+""==n+""&&n>=0&&t.call(r,e[n],+n,e)&&i.push(e[n]);return i},e.jstree.plugins.changed=function(e,t){var r=[];this.trigger=function(e,i){var n,s;if(i||(i={}),"changed"===e.replace(".jstree","")){i.changed={selected:[],deselected:[]};var a={};for(n=0,s=r.length;n<s;n++)a[r[n]]=1;for(n=0,s=i.selected.length;n<s;n++)a[i.selected[n]]?a[i.selected[n]]=2:i.changed.selected.push(i.selected[n]);for(n=0,s=r.length;n<s;n++)1===a[r[n]]&&i.changed.deselected.push(r[n]);r=i.selected.slice()}t.trigger.call(this,e,i)},this.refresh=function(e,i){return r=[],t.refresh.apply(this,arguments)}};var c=d.createElement("I");c.className="jstree-icon jstree-checkbox",c.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},e.jstree.plugins.checkbox=function(r,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var r,i,n=this._model.data,s=(n[t.parent],t.nodes);for(r=0,i=s.length;r<i;r++)n[s[r]].state.checked=n[s[r]].state.checked||n[s[r]].original&&n[s[r]].original.state&&n[s[r]].original.state.checked,n[s[r]].state.checked&&this._data.checkbox.selected.push(s[r])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",e.proxy(function(t,r){var i,n,s,a,o,l,d=this._model.data,c=d[r.parent],h=r.nodes,u=[],p=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection;if(-1!==p.indexOf("down"))if(c.state[f?"selected":"checked"]){for(n=0,s=h.length;n<s;n++)d[h[n]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(h)}else for(n=0,s=h.length;n<s;n++)if(d[h[n]].state[f?"selected":"checked"]){for(a=0,o=d[h[n]].children_d.length;a<o;a++)d[d[h[n]].children_d[a]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(d[h[n]].children_d)}if(-1!==p.indexOf("up")){for(n=0,s=c.children_d.length;n<s;n++)d[c.children_d[n]].children.length||u.push(d[c.children_d[n]].parent);for(u=e.vakata.array_unique(u),a=0,o=u.length;a<o;a++)for(c=d[u[a]];c&&c.id!==e.jstree.root;){for(i=0,n=0,s=c.children.length;n<s;n++)i+=d[c.children[n]].state[f?"selected":"checked"];if(i!==s)break;c.state[f?"selected":"checked"]=!0,this._data[f?"core":"checkbox"].selected.push(c.id),(l=this.get_node(c,!0))&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(f?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[f?"core":"checkbox"].selected=e.vakata.array_unique(this._data[f?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,r){var i,n,s,a,o=r.node,l=this._model.data,d=this.get_node(o.parent),c=this.settings.checkbox.cascade,h=this.settings.checkbox.tie_selection,u={},p=this._data[h?"core":"checkbox"].selected;for(i=0,n=p.length;i<n;i++)u[p[i]]=!0;if(-1!==c.indexOf("down")){var f=this._cascade_new_checked_state(o.id,!0);o.children_d.concat(o.id).forEach(function(e){f.indexOf(e)>-1?u[e]=!0:delete u[e]})}if(-1!==c.indexOf("up"))for(;d&&d.id!==e.jstree.root;){for(s=0,i=0,n=d.children.length;i<n;i++)s+=l[d.children[i]].state[h?"selected":"checked"];if(s!==n)break;d.state[h?"selected":"checked"]=!0,u[d.id]=!0,(a=this.get_node(d,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}p=[];for(i in u)u.hasOwnProperty(i)&&p.push(i);this._data[h?"core":"checkbox"].selected=p},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,r){var i,n,s,a=this.get_node(e.jstree.root),o=this._model.data;for(i=0,n=a.children_d.length;i<n;i++)(s=o[a.children_d[i]])&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(e,t){var r,i,n,s=t.node,a=(this.get_node(s,!0),this.settings.checkbox.cascade),o=this.settings.checkbox.tie_selection,l=this._data[o?"core":"checkbox"].selected,d=s.children_d.concat(s.id);if(-1!==a.indexOf("down")){var c=this._cascade_new_checked_state(s.id,!1);l=l.filter(function(e){return-1===d.indexOf(e)||c.indexOf(e)>-1})}if(-1!==a.indexOf("up")&&-1===l.indexOf(s.id)){for(r=0,i=s.parents.length;r<i;r++)n=this._model.data[s.parents[r]],n.state[o?"selected":"checked"]=!1,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1),(n=this.get_node(s.parents[r],!0))&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(o?"jstree-clicked":"jstree-checked");l=l.filter(function(e){return-1===s.parents.indexOf(e)})}this._data[o?"core":"checkbox"].selected=l},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,r){for(var i,n,s,a,o=this.get_node(r.parent),l=this._model.data,d=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[d?"selected":"checked"];){for(s=0,i=0,n=o.children.length;i<n;i++)s+=l[o.children[i]].state[d?"selected":"checked"];if(!(n>0&&s===n))break;o.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(o.id),(a=this.get_node(o,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,r){var i,n,s,a,o,l=r.is_multi,d=r.old_parent,c=this.get_node(r.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!l)for(i=this.get_node(d);i&&i.id!==e.jstree.root&&!i.state[u?"selected":"checked"];){for(n=0,s=0,a=i.children.length;s<a;s++)n+=h[i.children[s]].state[u?"selected":"checked"];if(!(a>0&&n===a))break;i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=c;i&&i.id!==e.jstree.root;){for(n=0,s=0,a=i.children.length;s<a;s++)n+=h[i.children[s]].state[u?"selected":"checked"];if(n===a)i.state[u?"selected":"checked"]||(i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!i.state[u?"selected":"checked"])break;i.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,i.id),(o=this.get_node(i,!0))&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this._undetermined=function(){if(null!==this.element){var r,i,n,s,a={},o=this._model.data,l=this.settings.checkbox.tie_selection,d=this._data[l?"core":"checkbox"].selected,c=[],h=this;for(r=0,i=d.length;r<i;r++)if(o[d[r]]&&o[d[r]].parents)for(n=0,s=o[d[r]].parents.length;n<s&&a[o[d[r]].parents[n]]===t;n++)o[d[r]].parents[n]!==e.jstree.root&&(a[o[d[r]].parents[n]]=!0,c.push(o[d[r]].parents[n]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var l,d=h.get_node(this);if(d)if(d.state.loaded){for(r=0,i=d.children_d.length;r<i;r++)if(l=o[d.children_d[r]],!l.state.loaded&&l.original&&l.original.state&&l.original.state.undetermined&&!0===l.original.state.undetermined)for(a[l.id]===t&&l.id!==e.jstree.root&&(a[l.id]=!0,c.push(l.id)),n=0,s=l.parents.length;n<s;n++)a[l.parents[n]]===t&&l.parents[n]!==e.jstree.root&&(a[l.parents[n]]=!0,c.push(l.parents[n]))}else if(d.original&&d.original.state&&d.original.state.undetermined&&!0===d.original.state.undetermined)for(a[d.id]===t&&d.id!==e.jstree.root&&(a[d.id]=!0,c.push(d.id)),n=0,s=d.parents.length;n<s;n++)a[d.parents[n]]===t&&d.parents[n]!==e.jstree.root&&(a[d.parents[n]]=!0,c.push(d.parents[n]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),r=0,i=c.length;r<i;r++)o[c[r]].state[l?"selected":"checked"]||(d=this.get_node(c[r],!0))&&d.length&&d.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(t,r,n,s){if(t=i.redraw_node.apply(this,arguments)){var a,o,l=null,d=null;for(a=0,o=t.childNodes.length;a<o;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(l.className+=" jstree-checked"),d=c.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(d.className+=" jstree-checkbox-disabled"),l.insertBefore(d,l.childNodes[0]))}return n||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var r,i,n=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,a=this._data[s?"core":"checkbox"].selected,o=this._model.data;if(!t||!0===t.state[s?"selected":"checked"]||-1===n.indexOf("undetermined")||-1===n.indexOf("down")&&-1===n.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(r=0,i=t.children_d.length;r<i;r++)if(-1!==e.inArray(t.children_d[r],a)||!o[t.children_d[r]].state.loaded&&o[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.disable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.enable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,r){return!e(r.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,r):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,r):this.check_node(t,r),void this.trigger("activate_node",{node:this.get_node(t)})))},this._cascade_new_checked_state=function(e,t){var r=this,i=this.settings.checkbox.tie_selection,n=this._model.data[e],s=[],a=[];if(!this.settings.checkbox.cascade_to_disabled&&n.state.disabled||!this.settings.checkbox.cascade_to_hidden&&n.state.hidden){var o=this.get_checked_descendants(e);n.state[i?"selected":"checked"]&&o.push(n.id),s=s.concat(o)}else{n.children&&n.children.forEach(function(e){var i=r._cascade_new_checked_state(e,t);s=s.concat(i),i.indexOf(e)>-1&&a.push(e)});var l=r.get_node(n,!0),d=a.length>0&&a.length<n.children.length;n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=d),d?(n.state[i?"selected":"checked"]=!1,l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(i?"jstree-clicked":"jstree-checked")):t&&a.length===n.children.length?(n.state[i?"selected":"checked"]=t,s.push(n.id),l.attr("aria-selected",!0).children(".jstree-anchor").addClass(i?"jstree-clicked":"jstree-checked")):(n.state[i?"selected":"checked"]=!1,l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(i?"jstree-clicked":"jstree-checked"))}return s},this.get_checked_descendants=function(e){var t=this,r=t.settings.checkbox.tie_selection;return t._model.data[e].children_d.filter(function(e){return t._model.data[e].state[r?"selected":"checked"]})},this.check_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,r);var i,n,s;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;n<s;n++)this.check_node(t[n],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.uncheck_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,r);var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.uncheck_node(t[i],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;s=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,r;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,r=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:r})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var r,i,n,s,a=this.get_checked(!0),o={};for(r=0,i=a.length;r<i;r++)o[a[r].id]=a[r];for(r=0,i=a.length;r<i;r++)for(n=0,s=a[r].children_d.length;n<s;n++)o[a[r].children_d[n]]&&delete o[a[r].children_d[n]];a=[];for(r in o)o.hasOwnProperty(r)&&a.push(r);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var r,i,n=this.get_checked(!0),s=[];for(r=0,i=n.length;r<i;r++)n[r].children.length||s.push(n[r].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.load_node=function(t,r){var n,s,a;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(a=this.get_node(t))&&a.state.loaded)for(n=0,s=a.children_d.length;n<s;n++)this._model.data[a.children_d[n]].state.checked&&(!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,a.children_d[n]));return i.load_node.apply(this,arguments)},this.get_state=function(){var e=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,r){var n=i.set_state.apply(this,arguments);if(n&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var s=this;e.each(t.checkbox,function(e,t){s.check_node(t)})}return delete t.checkbox,this.set_state(t,r),!1}return n},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,r){this.settings.conditionalselect.call(this,this.get_node(e),r)&&t.activate_node.call(this,e,r)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,r){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.create_node(i,{},"last",function(e){try{r.edit(e)}catch(t){setTimeout(function(){r.edit(e)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",/*!
     "shortcut"			: 113,
     "shortcut_label"	: 'F2',
     "icon"				: "glyphicon glyphicon-leaf",
     */
action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.delete_node(r.get_selected()):r.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.cut(r.get_top_selected()):r.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.copy(r.get_top_selected()):r.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.paste(i)}}}}}}},e.jstree.plugins.contextmenu=function(r,i){this.bind=function(){i.bind.call(this);var t,r,n=0,s=null;this.element.on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),n=e.ctrlKey?+new Date:0,(t||s)&&(n=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!n||+new Date-n>250)&&e.vakata.context.hide(),n=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(t=i.originalEvent.changedTouches[0].clientX,r=i.originalEvent.changedTouches[0].clientY,s=setTimeout(function(){e(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.originalEvent.changedTouches[0].clientX)>50||Math.abs(r-e.originalEvent.changedTouches[0].clientY)>50)&&clearTimeout(s)}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),/*!
   if(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {
   	var el = null, tm = null;
   	this.element
   		.on("touchstart", ".jstree-anchor", function (e) {
   			el = e.currentTarget;
   			tm = +new Date();
   			$(document).one("touchend", function (e) {
   				e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
   				e.currentTarget = e.target;
   				tm = ((+(new Date())) - tm);
   				if(e.target === el && tm > 600 && tm < 1000) {
   					e.preventDefault();
   					$(el).trigger('contextmenu', e);
   				}
   				el = null;
   				tm = null;
   			});
   		});
   }
   */
e(d).on("context_hide.vakata.jstree",e.proxy(function(t,r){this._data.contextmenu.visible=!1,e(r.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(r,i,n,s){if(!(r=this.get_node(r))||r.id===e.jstree.root)return!1;var a=this.settings.contextmenu,o=this.get_node(r,!0),l=o.children(".jstree-anchor"),d=!1,c=!1;(a.show_at_node||i===t||n===t)&&(d=l.offset(),i=d.left,n=d.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(r)&&this.activate_node(r,s),c=a.items,e.isFunction(c)&&(c=c.call(this,r,e.proxy(function(e){this._show_contextmenu(r,i,n,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(r,i,n,c)},this._show_contextmenu=function(t,r,i,n){var s=this.get_node(t,!0),a=s.children(".jstree-anchor");e(d).one("context_show.vakata.jstree",e.proxy(function(t,r){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(r.element).addClass(i),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:r,y:i},n),this.trigger("show_contextmenu",{node:t,x:r,y:i})}},function(e){var t=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(d).triggerHandler("context_"+t+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function(t){return!(!(t=r.items[t])||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:r.reference,element:r.element}))||!t.action)&&t.action.call(null,{item:t,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_parse:function(t,i){if(!t)return!1;i||(r.html="",r.items=[]);var n,s="",a=!1;return i&&(s+="<ul>"),e.each(t,function(t,i){if(!i)return!0;r.items.push(i),!a&&i.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,s+="<li class='"+(i._class||"")+(!0===i._disabled||e.isFunction(i._disabled)&&i._disabled({item:i,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(r.items.length-1)+"' "+(i.title?"title='"+i.title+"'":"")+">",e.vakata.context.settings.icons&&(s+="<i ",i.icon&&(-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?s+=" style='background:url(\""+i.icon+"\") center center no-repeat' ":s+=" class='"+i.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(i.label)?i.label({item:t,reference:r.reference,element:r.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(n=e.vakata.context._parse(i.submenu,!0))&&(s+=n),s+="</li>",i.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0)}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(s+="</ul>"),i||(r.html=s,e.vakata.context._trigger("parse")),s.length>10&&s},_show_submenu:function(r){if(r=e(r),r.length&&r.children("ul").length){var i=r.children("ul"),n=r.offset().left,s=n+r.outerWidth(),a=r.offset().top,o=i.width(),l=i.height(),d=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?r[s-(o+10+r.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):r[s+o>d&&n>d-s?"addClass":"removeClass"]("vakata-context-right"),a+l+10>c&&i.css("bottom","-1px"),r.hasClass("vakata-context-right")?n<o&&i.css("margin-right",n-o):d-s<o&&i.css("margin-left",d-s-o),i.show()}},show:function(i,n,s){var a,o,l,d,c,h,u,p;switch(r.element&&r.element.length&&r.element.width(""),!0){case!n&&!i:return!1;case!!n&&!!i:r.reference=i,r.position_x=n.x,r.position_y=n.y;break;case!n&&!!i:r.reference=i,a=i.offset(),r.position_x=a.left+i.outerHeight(),r.position_y=a.top;break;case!!n&&!i:r.position_x=n.x,r.position_y=n.y}i&&!s&&e(i).data("vakata_contextmenu")&&(s=e(i).data("vakata_contextmenu")),e.vakata.context._parse(s)&&r.element.html(r.html),r.items.length&&(r.element.appendTo("body"),o=r.element,l=r.position_x,d=r.position_y,c=o.width(),h=o.height(),u=e(window).width()+e(window).scrollLeft(),p=e(window).height()+e(window).scrollTop(),t&&(l-=o.outerWidth()-e(i).outerWidth())<e(window).scrollLeft()+20&&(l=e(window).scrollLeft()+20),l+c+20>u&&(l=u-(c+20)),d+h+20>p&&(d=p-(h+20)),r.element.css({left:l,top:d}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),r.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){r.is_visible&&(r.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),r.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var i=!1;r.element=e("<ul class='vakata-context'></ul>"),r.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(i&&clearTimeout(i),r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(t){return function(){e.vakata.context.hide()}}(),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||!1===e.vakata.context._execute(e(this).attr("rel"))||e.vakata.context.hide()}).on("keydown","a",function(t){var i=null;switch(t.which){case 13:case 32:t.type="click",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:r.is_visible&&(r.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:r.is_visible&&(i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),i.length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:r.is_visible&&(r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:r.is_visible&&(i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),i.length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=r.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(d).on("mousedown.vakata.jstree",function(t){r.is_visible&&r.element[0]!==t.target&&!e.contains(r.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,i){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&r.element.addClass("vakata-context-rtl").css("direction","rtl"),r.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var h,u;e.jstree.plugins.dnd=function(t,r){this.init=function(e,t){r.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in d.createElement("span")},this.bind=function(){r.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var r=this.get_node(t.target),i=this.is_selected(r)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,n=i>1?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(n=e.vakata.html.escape(n)),r&&r.id&&r.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_top_selected(!0):[r],t))){if(h={jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:i>1?this.get_top_selected():[r.id]},u=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,h,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+n+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:u,data:h})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:u,data:h}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:u,data:h}),!1},this))},this.redraw_node=function(e,t,i,n){if((e=r.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var s,a,o=null;for(s=0,a=e.childNodes.length;s<a;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){o=e.childNodes[s];break}o&&o.setAttribute("draggable",!0)}return e}},e(function(){var r=!1,i=!1,n=!1,s=!1,a=e('<div id="jstree-marker">&#160;</div>').hide();e(d).on("dnd_start.vakata.jstree",function(e,t){r=!1,n=!1,t&&t.data&&t.data.jstree&&a.appendTo("body")}).on("dnd_move.vakata.jstree",function(o,l){var d=l.event.target!==n.target;if(s&&(l.event&&"dragover"===l.event.type&&!d||clearTimeout(s)),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){n=l.event;var c,h,u,p,f,_,g,m,v,y,j,b,x,w,k,C,A=e.jstree.reference(l.event.target),$=!1,T=!1,E=!1;if(A&&A._data&&A._data.dnd)if(a.attr("class","jstree-"+A.get_theme()+(A.settings.core.themes.responsive?" jstree-dnd-responsive":"")),k=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+A.get_theme()+" jstree-"+A.get_theme()+"-"+A.get_theme_variant()+" "+(A.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[k?"show":"hide"](),l.event.target!==A.element[0]&&l.event.target!==A.get_container_ul()[0]||0!==A.get_container_ul().children().length){if(($=A.settings.dnd.large_drop_target?e(l.event.target).closest(".jstree-node").children(".jstree-anchor"):e(l.event.target).closest(".jstree-anchor"))&&$.length&&$.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(T=$.offset(),E=(l.event.pageY!==t?l.event.pageY:l.event.originalEvent.pageY)-T.top,u=$.outerHeight(),_=E<u/3?["b","i","a"]:E>u-u/3?["a","i","b"]:E>u/2?["i","a","b"]:["i","b","a"],e.each(_,function(t,n){switch(n){case"b":c=T.left-6,h=T.top,p=A.get_parent($),f=$.parent().index();break;case"i":x=A.settings.dnd.inside_pos,w=A.get_node($.parent()),c=T.left-2,h=T.top+u/2+1,p=w.id,f="first"===x?0:"last"===x?w.children.length:Math.min(x,w.children.length);break;case"a":c=T.left-6,h=T.top+u,p=A.get_parent($),f=$.parent().index()+1}for(g=!0,m=0,v=l.data.nodes.length;m<v;m++)if(y=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",j=f,"move_node"===y&&"a"===n&&l.data.origin&&l.data.origin===A&&p===A.get_parent(l.data.nodes[m])&&(b=A.get_node(p),j>e.inArray(l.data.nodes[m],b.children)&&(j-=1)),!(g=g&&(A&&A.settings&&A.settings.dnd&&!1===A.settings.dnd.check_while_dragging||A.check(y,l.data.origin&&l.data.origin!==A?l.data.origin.get_node(l.data.nodes[m]):l.data.nodes[m],p,j,{dnd:!0,ref:A.get_node($.parent()),pos:n,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==A,is_foreign:!l.data.origin})))){A&&A.last_error&&(i=A.last_error());break}if("i"===n&&$.parent().is(".jstree-closed")&&A.settings.dnd.open_timeout&&(l.event&&"dragover"===l.event.type&&!d||(s&&clearTimeout(s),s=setTimeout(function(e,t){return function(){e.open_node(t)}}(A,$),A.settings.dnd.open_timeout))),g)return C=A.get_node(p,!0),C.hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),C.addClass("jstree-dnd-parent")),r={ins:A,par:p,pos:"i"!==n||"last"!==x||0!==f||A.is_loaded(w)?f:"last"},a.css({left:c+"px",top:h+"px"}).show(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=k?"copy":"move"),i={},_=!0,!1}),!0===_))return}else{for(g=!0,m=0,v=l.data.nodes.length;m<v&&(g=g&&A.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==A?l.data.origin.get_node(l.data.nodes[m]):l.data.nodes[m],e.jstree.root,"last",{dnd:!0,ref:A.get_node(e.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==A,is_foreign:!l.data.origin}));m++);if(g)return r={ins:A,par:e.jstree.root,pos:"last"},a.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=k?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),r=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect="none"),a.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(a.hide(),r=!1,n=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,o){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),s&&clearTimeout(s),o&&o.data&&o.data.jstree){a.hide().detach();var l,d,c=[];if(r){for(l=0,d=o.data.nodes.length;l<d;l++)c[l]=o.data.origin?o.data.origin.get_node(o.data.nodes[l]):o.data.nodes[l];r.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](c,r.par,r.pos,!1,!1,!1,o.data.origin)}else l=e(o.event.target).closest(".jstree"),l.length&&i&&i.error&&"check"===i.error&&(l=l.jstree(!0))&&l.settings.core.error.call(this,i);n=!1,r=!1}}).on("keyup.jstree keydown.jstree",function(t,o){(o=e.vakata.dnd._get())&&o.data&&o.data.jstree&&("keyup"===t.type&&27===t.which?(s&&clearTimeout(s),r=!1,i=!1,n=!1,s=!1,a.hide().detach(),e.vakata.dnd._clean()):(o.helper.find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),n&&(n.metaKey=t.metaKey,n.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",n))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(r,i,n){n===t&&(n=e.vakata.dnd._get()),n.event=i,e(d).triggerHandler("dnd_"+r+".vakata",n)},_get:function(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function(){r.helper&&r.helper.remove(),r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(d).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t)return r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),!1;if(!r.scroll_i)return r.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===t)return!1;var i=r.scroll_e.scrollTop(),n=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(i+r.scroll_t*e.vakata.dnd.settings.scroll_speed),r.scroll_e.scrollLeft(n+r.scroll_l*e.vakata.dnd.settings.scroll_speed),i===r.scroll_e.scrollTop()&&n===r.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",r.scroll_e)},start:function(t,i,n){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return r.init_x=t.pageX,r.init_y=t.pageY,r.data=i,r.is_down=!0,r.element=t.currentTarget,r.target=t.target,r.is_touch="touchstart"===t.type,!1!==n&&(r.helper=e("<div id='vakata-dnd'></div>").html(n).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(d).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_down){if(!r.is_drag){if(!(Math.abs(t.pageX-r.init_x)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-r.init_y)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;r.helper&&(r.helper.appendTo("body"),r.helper_w=r.helper.outerWidth()),r.is_drag=!0,e(r.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var i=!1,n=!1,s=!1,a=!1,o=!1,l=!1,c=!1,h=!1,u=!1,p=!1;return r.scroll_t=0,r.scroll_l=0,r.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),n=i.offset();if(this.scrollHeight>this.offsetHeight&&(n.top+i.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),t.pageY-n.top<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(n.left+i.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),t.pageX-n.left<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1)),r.scroll_t||r.scroll_l)return r.scroll_e=e(this),!1}),r.scroll_e||(i=e(d),n=e(window),s=i.height(),a=n.height(),o=i.width(),l=n.width(),c=i.scrollTop(),h=i.scrollLeft(),s>a&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1),s>a&&a-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),o>l&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1),o>l&&l-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),(r.scroll_t||r.scroll_l)&&(r.scroll_e=i)),r.scroll_e&&e.vakata.dnd._scroll(!0),r.helper&&(u=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),p=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),o&&p+r.helper_w>o&&(p=o-(r.helper_w+2)),r.helper.css({left:p+"px",top:u+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag)t.target!==r.target&&e(r.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===r.target){var i=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){i&&clearTimeout(i)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,r){this.init=function(e,t){this._data.massload={},r.init.call(this,e,t)},this._load_nodes=function(t,i,n,s){var o,l,d,c=this.settings.massload,h=(JSON.stringify(t),[]),u=this._model.data;if(!n){for(o=0,l=t.length;o<l;o++)u[t[o]]&&(u[t[o]].state.loaded||u[t[o]].state.failed)&&!s||(h.push(t[o]),(d=this.get_node(t[o],!0))&&d.length&&d.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},h.length){if(e.isFunction(c))return c.call(this,h,e.proxy(function(e){var a,o;if(e)for(a in e)e.hasOwnProperty(a)&&(this._data.massload[a]=e[a]);for(a=0,o=t.length;a<o;a++)(d=this.get_node(t[a],!0))&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,s)},this));if("object"===(void 0===c?"undefined":a(c))&&c&&c.url)return c=e.extend(!0,{},c),e.isFunction(c.url)&&(c.url=c.url.call(this,h)),e.isFunction(c.data)&&(c.data=c.data.call(this,h)),e.ajax(c).done(e.proxy(function(e,a,o){var l,c;if(e)for(l in e)e.hasOwnProperty(l)&&(this._data.massload[l]=e[l]);for(l=0,c=t.length;l<c;l++)(d=this.get_node(t[l],!0))&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,s)},this)).fail(e.proxy(function(e){r._load_nodes.call(this,t,i,n,s)},this))}}return r._load_nodes.call(this,t,i,n,s)},this._load_node=function(t,i){var n,s=this._data.massload[t.id],a=null;return s?(a=this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}):s,function(e){i.call(this,e)}),n=this.get_node(t.id,!0),n&&n.length&&n.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],a):r._load_node.call(this,t,i)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(r,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,r){if(this._data.search.som&&r.res.length){var i,n,s,a,o=this._model.data,l=[];for(i=0,n=r.res.length;i<n;i++)if(o[r.res[i]]&&!o[r.res[i]].state.hidden&&(l.push(r.res[i]),l=l.concat(o[r.res[i]].parents),this._data.search.smc))for(s=0,a=o[r.res[i]].children_d.length;s<a;s++)o[o[r.res[i]].children_d[s]]&&!o[o[r.res[i]].children_d[s]].state.hidden&&l.push(o[r.res[i]].children_d[s]);l=e.vakata.array_remove_item(e.vakata.array_unique(l),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(r,i,n,s,a,o){if(!1===r||""===e.trim(r.toString()))return this.clear_search();s=this.get_node(s),s=s&&s.id?s.id:null,r=r.toString();var l,d,c=this.settings.search,h=!!c.ajax&&c.ajax,u=this._model.data,p=null,f=[],_=[];if(this._data.search.res.length&&!a&&this.clear_search(),n===t&&(n=c.show_only_matches),o===t&&(o=c.show_only_matches_children),!i&&!1!==h)return e.isFunction(h)?h.call(this,r,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,s,a,o)})},this),s):(h=e.extend({},h),h.data||(h.data={}),h.data.str=r,s&&(h.data.inside=s),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,s,a,o)})},this)),this._data.search.lastRequest);if(a||(this._data.search.str=r,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=n,this._data.search.smc=o),p=new e.vakata.search(r,!0,{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),e.each(u[s||e.jstree.root].children_d,function(e,t){var i=u[t];i.text&&!i.state.hidden&&(!c.search_leaves_only||i.state.loaded&&0===i.children.length)&&(c.search_callback&&c.search_callback.call(this,r,i)||!c.search_callback&&p.search(i.text).isMatch)&&(f.push(t),_=_.concat(i.parents))}),f.length){for(_=e.vakata.array_unique(_),l=0,d=_.length;l<d;l++)_[l]!==e.jstree.root&&u[_[l]]&&!0===this.open_node(_[l],null,0)&&this._data.search.opn.push(_[l]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(f,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(f))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(f,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=f),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:n})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,r,n,s){if((t=i.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){var a,o,l=null;for(a=0,o=t.childNodes.length;a<o;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){l=t.childNodes[a];break}l&&(l.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,r,i){i=i||{},i=e.extend({},e.vakata.search.defaults,i),!1!==i.fuzzy&&(i.fuzzy=!0),t=i.caseSensitive?t:t.toLowerCase();var n,s,a,o,l=i.location,d=i.distance,c=i.threshold,h=t.length;return h>32&&(i.fuzzy=!1),i.fuzzy&&(n=1<<h-1,s=function(){var e={},r=0;for(r=0;r<h;r++)e[t.charAt(r)]=0;for(r=0;r<h;r++)e[t.charAt(r)]|=1<<h-r-1;return e}(),a=function(e,t){var r=e/h,i=Math.abs(l-t);return d?r+i/d:i?1:r}),o=function(e){if(e=i.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var r,o,d,u,p,f,_,g,m,v=e.length,y=c,j=e.indexOf(t,l),b=h+v,x=1,w=[];for(-1!==j&&(y=Math.min(a(0,j),y),-1!==(j=e.lastIndexOf(t,l+h))&&(y=Math.min(a(0,j),y))),j=-1,r=0;r<h;r++){for(d=0,u=b;d<u;)a(r,l+u)<=y?d=u:b=u,u=Math.floor((b-d)/2+d);for(b=u,f=Math.max(1,l-u+1),_=Math.min(l+u,v)+h,g=new Array(_+2),g[_+1]=(1<<r)-1,o=_;o>=f;o--)if(m=s[e.charAt(o-1)],g[o]=0===r?(g[o+1]<<1|1)&m:(g[o+1]<<1|1)&m|(p[o+1]|p[o])<<1|1|p[o+1],g[o]&n&&(x=a(r,o-1))<=y){if(y=x,j=o-1,w.push(j),!(j>l))break;f=Math.max(1,2*l-j)}if(a(r+1,l)>y)break;p=g}return{isMatch:j>=0,score:x}},!0===r?{search:o}:o(r)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,r){var i,n;if((t=this.get_node(t))&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),r))for(i=0,n=t.children_d.length;i<n;i++)this.sort(t.children_d[i],!1)}};var p=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,r){this.bind=function(){r.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){p&&clearTimeout(p),p=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,r){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(r,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(r,i){this.init=function(r,n){var s,a;if(n&&n.types&&n.types.default)for(s in n.types)if("default"!==s&&s!==e.jstree.root&&n.types.hasOwnProperty(s))for(a in n.types.default)n.types.default.hasOwnProperty(a)&&n.types[s][a]===t&&(n.types[s][a]=n.types.default[a]);i.init.call(this,r,n),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,r){i.refresh.call(this,t,r),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(r,i){var n,s,o,l=this._model.data,d=i.nodes,c=this.settings.types,h="default";for(n=0,s=d.length;n<s;n++){if(h="default",l[d[n]].original&&l[d[n]].original.type&&c[l[d[n]].original.type]&&(h=l[d[n]].original.type),l[d[n]].data&&l[d[n]].data.jstree&&l[d[n]].data.jstree.type&&c[l[d[n]].data.jstree.type]&&(h=l[d[n]].data.jstree.type),l[d[n]].type=h,!0===l[d[n]].icon&&c[h].icon!==t&&(l[d[n]].icon=c[h].icon),c[h].li_attr!==t&&"object"===a(c[h].li_attr))for(o in c[h].li_attr)if(c[h].li_attr.hasOwnProperty(o)){if("id"===o)continue;l[d[n]].li_attr[o]===t?l[d[n]].li_attr[o]=c[h].li_attr[o]:"class"===o&&(l[d[n]].li_attr.class=c[h].li_attr.class+" "+l[d[n]].li_attr.class)}if(c[h].a_attr!==t&&"object"===a(c[h].a_attr))for(o in c[h].a_attr)if(c[h].a_attr.hasOwnProperty(o)){if("id"===o)continue;l[d[n]].a_attr[o]===t?l[d[n]].a_attr[o]=c[h].a_attr[o]:"href"===o&&"#"===l[d[n]].a_attr[o]?l[d[n]].a_attr.href=c[h].a_attr.href:"class"===o&&(l[d[n]].a_attr.class=c[h].a_attr.class+" "+l[d[n]].a_attr.class)}}l[e.jstree.root].type=e.jstree.root},this)),i.bind.call(this)},this.get_json=function(t,r,n){var s,a,o=this._model.data,l=r?e.extend(!0,{},r,{no_id:!1}):{},d=i.get_json.call(this,t,l,n);if(!1===d)return!1;if(e.isArray(d))for(s=0,a=d.length;s<a;s++)d[s].type=d[s].id&&o[d[s].id]&&o[d[s].id].type?o[d[s].id].type:"default",r&&r.no_id&&(delete d[s].id,d[s].li_attr&&d[s].li_attr.id&&delete d[s].li_attr.id,d[s].a_attr&&d[s].a_attr.id&&delete d[s].a_attr.id);else d.type=d.id&&o[d.id]&&o[d.id].type?o[d.id].type:"default",r&&r.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(t){if(e.isArray(t)){for(var r=0,i=t.length;r<i;r++)t[r]=this._delete_ids(t[r]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(r,n,s,a,o){if(!1===i.check.call(this,r,n,s,a,o))return!1;n=n&&n.id?n:this.get_node(n),s=s&&s.id?s:this.get_node(s);var l,d,c,h,u=n&&n.id?o&&o.origin?o.origin:e.jstree.reference(n.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,r){case"create_node":case"move_node":case"copy_node":if("move_node"!==r||-1===e.inArray(n.id,s.children)){if(l=this.get_rules(s),l.max_children!==t&&-1!==l.max_children&&l.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;if(l.valid_children!==t&&-1!==l.valid_children&&-1===e.inArray(n.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;if(u&&n.children_d&&n.parents){for(d=0,c=0,h=n.children_d.length;c<h;c++)d=Math.max(d,u[n.children_d[c]].parents.length);d=d-n.parents.length+1}(d<=0||d===t)&&(d=1);do{if(l.max_depth!==t&&-1!==l.max_depth&&l.max_depth<d)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;s=this.get_node(s.parent),l=this.get_rules(s),d++}while(s)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var r=this.get_type(e,!0);return r.max_depth===t&&(r.max_depth=-1),r.max_children===t&&(r.max_children=-1),r.valid_children===t&&(r.valid_children=-1),r},this.get_type=function(t,r){return!!(t=this.get_node(t))&&(r?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(r,i){var n,s,o,l,d,c,h,u,p=this._model.data;if(e.isArray(r)){for(r=r.slice(),s=0,o=r.length;s<o;s++)this.set_type(r[s],i);return!0}if(n=this.settings.types,r=this.get_node(r),!n[i]||!r)return!1;if(h=this.get_node(r,!0),h&&h.length&&(u=h.children(".jstree-anchor")),l=r.type,d=this.get_icon(r),r.type=i,(!0===d||!n[l]||n[l].icon!==t&&d===n[l].icon)&&this.set_icon(r,n[i].icon===t||n[i].icon),n[l]&&n[l].li_attr!==t&&"object"===a(n[l].li_attr))for(c in n[l].li_attr)if(n[l].li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(p[r.id].li_attr.class=(p[r.id].li_attr.class||"").replace(n[l].li_attr[c],""),h&&h.removeClass(n[l].li_attr[c])):p[r.id].li_attr[c]===n[l].li_attr[c]&&(p[r.id].li_attr[c]=null,h&&h.removeAttr(c))}if(n[l]&&n[l].a_attr!==t&&"object"===a(n[l].a_attr))for(c in n[l].a_attr)if(n[l].a_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(p[r.id].a_attr.class=(p[r.id].a_attr.class||"").replace(n[l].a_attr[c],""),u&&u.removeClass(n[l].a_attr[c])):p[r.id].a_attr[c]===n[l].a_attr[c]&&("href"===c?(p[r.id].a_attr[c]="#",u&&u.attr("href","#")):(delete p[r.id].a_attr[c],u&&u.removeAttr(c)))}if(n[i].li_attr!==t&&"object"===a(n[i].li_attr))for(c in n[i].li_attr)if(n[i].li_attr.hasOwnProperty(c)){if("id"===c)continue;p[r.id].li_attr[c]===t?(p[r.id].li_attr[c]=n[i].li_attr[c],h&&("class"===c?h.addClass(n[i].li_attr[c]):h.attr(c,n[i].li_attr[c]))):"class"===c&&(p[r.id].li_attr.class=n[i].li_attr[c]+" "+p[r.id].li_attr.class,h&&h.addClass(n[i].li_attr[c]))}if(n[i].a_attr!==t&&"object"===a(n[i].a_attr))for(c in n[i].a_attr)if(n[i].a_attr.hasOwnProperty(c)){if("id"===c)continue;p[r.id].a_attr[c]===t?(p[r.id].a_attr[c]=n[i].a_attr[c],u&&("class"===c?u.addClass(n[i].a_attr[c]):u.attr(c,n[i].a_attr[c]))):"href"===c&&"#"===p[r.id].a_attr[c]?(p[r.id].a_attr.href=n[i].a_attr.href,u&&u.attr("href",n[i].a_attr.href)):"class"===c&&(p[r.id].a_attr.class=n[i].a_attr.class+" "+p[r.id].a_attr.class,u&&u.addClass(n[i].a_attr[c]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(r,i){this.check=function(t,r,n,s,a){if(!1===i.check.call(this,t,r,n,s,a))return!1;if(r=r&&r.id?r:this.get_node(r),!(n=n&&n.id?n:this.get_node(n))||!n.children)return!0;var o,l,d="rename_node"===t?s:r.text,c=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(o=0,l=n.children.length;o<l;o++)c.push(h?u[n.children[o]].text:u[n.children[o]].text.toLowerCase());switch(h||(d=d.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=-1===e.inArray(d,c)||r.text&&r.text[h?"toString":"toLowerCase"]()===d,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+d+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"create_node":return o=-1===e.inArray(d,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+d+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"copy_node":return o=-1===e.inArray(d,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+d+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"move_node":return o=r.parent===n.id&&(!a||!a.is_multi)||-1===e.inArray(d,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+d+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o}return!0},this.create_node=function(r,n,s,a,o){if(!n||n.text===t){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return i.create_node.call(this,r,n,s,a,o);if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return i.create_node.call(this,r,n,s,a,o);n||(n={});var l,d,c,h,u,p=this._model.data,f=this.settings.unique.case_sensitive,_=this.settings.unique.duplicate;for(d=l=this.get_string("New node"),c=[],h=0,u=r.children.length;h<u;h++)c.push(f?p[r.children[h]].text:p[r.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(f?d:d.toLowerCase(),c);)d=_.call(this,l,++h).toString();n.text=d}return i.create_node.call(this,r,n,s,a,o)}};var f=d.createElement("DIV");if(f.setAttribute("unselectable","on"),f.setAttribute("role","presentation"),f.className="jstree-wholerow",f.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r,i,n=!1;for(r=0,i=t.selected.length;r<i;r++)(n=this.get_node(t.selected[r],!0))&&n.length&&n.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var r=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),r.teardown.call(this)},this.redraw_node=function(t,i,n,s){if(t=r.redraw_node.apply(this,arguments)){var a=f.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},d.registerElement&&Object&&Object.create){var _=Object.create(HTMLElement.prototype);_.createdCallback=function(){var t,r={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(r.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(r[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(r.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(r)};try{d.registerElement("vakata-jstree",{prototype:_})}catch(e){}}}})},function(e,t,r){"use strict";(function(i){var n,s,a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
 * Select2 4.0.3
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
!function(i){s=[r(1)],n=i,void 0!==(a="function"==typeof n?n.apply(t,s):n)&&(e.exports=a)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;return function(){if(!t||!t.requirejs){t?r=t:t={};/**
         * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
         * Available via the MIT or new BSD license.
         * see: http://github.com/jrburke/almond for details
         */
var e,r,i;!function(t){function n(e,t){return b.call(e,t)}function s(e,t){var r,i,n,s,a,o,l,d,c,h,u,p=t&&t.split("/"),f=y.map,_=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),a=e.length-1,y.nodeIdCompat&&w.test(e[a])&&(e[a]=e[a].replace(w,"")),e=p.slice(0,p.length-1).concat(e),c=0;c<e.length;c+=1)if("."===(u=e[c]))e.splice(c,1),c-=1;else if(".."===u){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||_)&&f){for(r=e.split("/"),c=r.length;c>0;c-=1){if(i=r.slice(0,c).join("/"),p)for(h=p.length;h>0;h-=1)if((n=f[p.slice(0,h).join("/")])&&(n=n[i])){s=n,o=c;break}if(s)break;!l&&_&&_[i]&&(l=_[i],d=c)}!s&&l&&(s=l,o=d),s&&(r.splice(0,o,s),e=r.join("/"))}return e}function a(e,r){return function(){var i=x.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),f.apply(t,i.concat([e,r]))}}function l(e){return function(t){return s(t,e)}}function d(e){return function(t){m[e]=t}}function c(e){if(n(v,e)){var r=v[e];delete v[e],j[e]=!0,p.apply(t,r)}if(!n(m,e)&&!n(j,e))throw new Error("No "+e);return m[e]}function h(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function u(e){return function(){return y&&y.config&&y.config[e]||{}}}var p,f,_,g,m={},v={},y={},j={},b=Object.prototype.hasOwnProperty,x=[].slice,w=/\.js$/;_=function(e,t){var r,i=h(e),n=i[0];return e=i[1],n&&(n=s(n,t),r=c(n)),n?e=r&&r.normalize?r.normalize(e,l(t)):s(e,t):(e=s(e,t),i=h(e),n=i[0],e=i[1],n&&(r=c(n))),{f:n?n+"!"+e:e,n:e,pr:n,p:r}},g={require:function(e){return a(e)},exports:function(e){var t=m[e];return void 0!==t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:u(e)}}},p=function(e,r,i,s){var l,h,u,p,f,y,b=[],x=void 0===i?"undefined":o(i);if(s=s||e,"undefined"===x||"function"===x){for(r=!r.length&&i.length?["require","exports","module"]:r,f=0;f<r.length;f+=1)if(p=_(r[f],s),"require"===(h=p.f))b[f]=g.require(e);else if("exports"===h)b[f]=g.exports(e),y=!0;else if("module"===h)l=b[f]=g.module(e);else if(n(m,h)||n(v,h)||n(j,h))b[f]=c(h);else{if(!p.p)throw new Error(e+" missing "+h);p.p.load(p.n,a(s,!0),d(h),{}),b[f]=m[h]}u=i?i.apply(m[e],b):void 0,e&&(l&&l.exports!==t&&l.exports!==m[e]?m[e]=l.exports:u===t&&y||(m[e]=u))}else e&&(m[e]=i)},e=r=f=function(e,r,i,n,s){if("string"==typeof e)return g[e]?g[e](r):c(_(e,r).f);if(!e.splice){if(y=e,y.deps&&f(y.deps,y.callback),!r)return;r.splice?(e=r,r=i,i=null):e=t}return r=r||function(){},"function"==typeof i&&(i=n,n=s),n?p(t,e,r,i):setTimeout(function(){p(t,e,r,i)},4),f},f.config=function(e){return f(e)},e._defined=m,i=function(e,t,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(r=t,t=[]),n(m,e)||n(v,e)||(v[e]=[e,t,r])},i.amd={jQuery:!0}}(),t.requirejs=e,t.require=r,t.define=i}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||i;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,r=[];for(var i in t){"function"==typeof t[i]&&("constructor"!==i&&r.push(i))}return r}var r={};r.Extend=function(e,t){function r(){this.constructor=e}var i={}.hasOwnProperty;for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},r.Decorate=function(e,r){function i(){var t=Array.prototype.unshift,i=r.prototype.constructor.length,n=e.prototype.constructor;i>0&&(t.call(arguments,e.prototype.constructor),n=r.prototype.constructor),n.apply(this,arguments)}function n(){this.constructor=i}var s=t(r),a=t(e);r.displayName=e.displayName,i.prototype=new n;for(var o=0;o<a.length;o++){var l=a[o];i.prototype[l]=e.prototype[l]}for(var d=0;d<s.length;d++){var c=s[d];i.prototype[c]=function(e){var t=function(){};e in i.prototype&&(t=i.prototype[e]);var n=r.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}}(c)}return i};var i=function(){this.listeners={}};return i.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},i.prototype.trigger=function(e){var t=Array.prototype.slice,r=t.call(arguments,1);this.listeners=this.listeners||{},null==r&&(r=[]),0===r.length&&r.push({}),r[0]._type=e,e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},i.prototype.invoke=function(e,t){for(var r=0,i=e.length;r<i;r++)e[r].apply(this,t)},r.Observable=i,r.generateChars=function(e){for(var t="",r=0;r<e;r++){t+=Math.floor(36*Math.random()).toString(36)}return t},r.bind=function(e,t){return function(){e.apply(t,arguments)}},r._convertData=function(e){for(var t in e){var r=t.split("-"),i=e;if(1!==r.length){for(var n=0;n<r.length;n++){var s=r[n];s=s.substring(0,1).toLowerCase()+s.substring(1),s in i||(i[s]={}),n==r.length-1&&(i[s]=e[t]),i=i[s]}delete e[t]}}return e},r.hasScroll=function(t,r){var i=e(r),n=r.style.overflowX,s=r.style.overflowY;return(n!==s||"hidden"!==s&&"visible"!==s)&&("scroll"===n||"scroll"===s||(i.innerHeight()<r.scrollHeight||i.innerWidth()<r.scrollWidth))},r.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},r.appendMany=function(t,r){if("1.7"===e.fn.jquery.substr(0,3)){var i=e();e.map(r,function(e){i=i.add(e)}),r=i}t.append(r)},r}),t.define("select2/results",["jquery","./utils"],function(e,t){function r(e,t,i){this.$element=e,this.data=i,this.options=t,r.__super__.constructor.call(this)}return t.Extend(r,t.Observable),r.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},r.prototype.clear=function(){this.$results.empty()},r.prototype.displayMessage=function(t){var r=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var i=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),n=this.options.get("translations").get(t.message);i.append(r(n(t.args))),i[0].className+=" select2-results__message",this.$results.append(i)},r.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},r.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var r=0;r<e.results.length;r++){var i=e.results[r],n=this.option(i);t.push(n)}this.$results.append(t)},r.prototype.position=function(e,t){t.find(".select2-results").append(e)},r.prototype.sort=function(e){return this.options.get("sorter")(e)},r.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");t.length>0?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},r.prototype.setClasses=function(){var t=this;this.data.current(function(r){var i=e.map(r,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var t=e(this),r=e.data(this,"data"),n=""+r.id;null!=r.element&&r.element.selected||null==r.element&&e.inArray(n,i)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")})})},r.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),r={disabled:!0,loading:!0,text:t(e)},i=this.option(r);i.className+=" loading-results",this.$results.prepend(i)},r.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},r.prototype.option=function(t){var r=document.createElement("li");r.className="select2-results__option";var i={role:"treeitem","aria-selected":"false"};t.disabled&&(delete i["aria-selected"],i["aria-disabled"]="true"),null==t.id&&delete i["aria-selected"],null!=t._resultId&&(r.id=t._resultId),t.title&&(r.title=t.title),t.children&&(i.role="group",i["aria-label"]=t.text,delete i["aria-selected"]);for(var n in i){var s=i[n];r.setAttribute(n,s)}if(t.children){var a=e(r),o=document.createElement("strong");o.className="select2-results__group";e(o);this.template(t,o);for(var l=[],d=0;d<t.children.length;d++){var c=t.children[d],h=this.option(c);l.push(h)}var u=e("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});u.append(l),a.append(o),a.append(u)}else this.template(t,r);return e.data(r,"data",t),r},r.prototype.bind=function(t,r){var i=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){i.clear(),i.append(e.data),t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("results:append",function(e){i.append(e.data),t.isOpen()&&i.setClasses()}),t.on("query",function(e){i.hideMessages(),i.showLoading(e)}),t.on("select",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("open",function(){i.$results.attr("aria-expanded","true"),i.$results.attr("aria-hidden","false"),i.setClasses(),i.ensureHighlightVisible()}),t.on("close",function(){i.$results.attr("aria-expanded","false"),i.$results.attr("aria-hidden","true"),i.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=i.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=i.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?i.trigger("close",{}):i.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=i.getHighlightedResults(),t=i.$results.find("[aria-selected]"),r=t.index(e);if(0!==r){var n=r-1;0===e.length&&(n=0);var s=t.eq(n);s.trigger("mouseenter");var a=i.$results.offset().top,o=s.offset().top,l=i.$results.scrollTop()+(o-a);0===n?i.$results.scrollTop(0):o-a<0&&i.$results.scrollTop(l)}}),t.on("results:next",function(){var e=i.getHighlightedResults(),t=i.$results.find("[aria-selected]"),r=t.index(e),n=r+1;if(!(n>=t.length)){var s=t.eq(n);s.trigger("mouseenter");var a=i.$results.offset().top+i.$results.outerHeight(!1),o=s.offset().top+s.outerHeight(!1),l=i.$results.scrollTop()+o-a;0===n?i.$results.scrollTop(0):o>a&&i.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){i.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=i.$results.scrollTop(),r=i.$results.get(0).scrollHeight-t+e.deltaY,n=e.deltaY>0&&t-e.deltaY<=0,s=e.deltaY<0&&r<=i.$results.height();n?(i.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):s&&(i.$results.scrollTop(i.$results.get(0).scrollHeight-i.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var r=e(this),n=r.data("data");if("true"===r.attr("aria-selected"))return void(i.options.get("multiple")?i.trigger("unselect",{originalEvent:t,data:n}):i.trigger("close",{}));i.trigger("select",{originalEvent:t,data:n})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(t){var r=e(this).data("data");i.getHighlightedResults().removeClass("select2-results__option--highlighted"),i.trigger("results:focus",{data:r,element:e(this)})})},r.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},r.prototype.destroy=function(){this.$results.remove()},r.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),r=t.index(e),i=this.$results.offset().top,n=e.offset().top,s=this.$results.scrollTop()+(n-i),a=n-i;s-=2*e.outerHeight(!1),r<=2?this.$results.scrollTop(0):(a>this.$results.outerHeight()||a<0)&&this.$results.scrollTop(s)}},r.prototype.template=function(t,r){var i=this.options.get("templateResult"),n=this.options.get("escapeMarkup"),s=i(t,r);null==s?r.style.display="none":"string"==typeof s?r.innerHTML=n(s):e(r).append(s)},r}),t.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,r){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},i.prototype.bind=function(e,t){var i=this,n=(e.id,e.id+"-results");this.container=e,this.$selection.on("focus",function(e){i.trigger("focus",e)}),this.$selection.on("blur",function(e){i._handleBlur(e)}),this.$selection.on("keydown",function(e){i.trigger("keypress",e),e.which===r.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){i.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){i.update(e.data)}),e.on("open",function(){i.$selection.attr("aria-expanded","true"),i.$selection.attr("aria-owns",n),i._attachCloseHandler(e)}),e.on("close",function(){i.$selection.attr("aria-expanded","false"),i.$selection.removeAttr("aria-activedescendant"),i.$selection.removeAttr("aria-owns"),i.$selection.focus(),i._detachCloseHandler(e)}),e.on("enable",function(){i.$selection.attr("tabindex",i._tabindex)}),e.on("disable",function(){i.$selection.attr("tabindex","-1")})},i.prototype._handleBlur=function(t){var r=this;window.setTimeout(function(){document.activeElement==r.$selection[0]||e.contains(r.$selection[0],document.activeElement)||r.trigger("blur",t)},1)},i.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var r=e(t.target),i=r.closest(".select2");e(".select2.select2-container--open").each(function(){var t=e(this);this!=i[0]&&t.data("element").select2("close")})})},i.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},i.prototype.position=function(e,t){t.find(".selection").append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,r,i){function n(){n.__super__.constructor.apply(this,arguments)}return r.Extend(n,t),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},n.prototype.bind=function(e,t){var r=this;n.__super__.bind.apply(this,arguments);var i=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&r.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),e.on("focus",function(t){e.isOpen()||r.$selection.focus()}),e.on("selection:update",function(e){r.update(e.data)})},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(e,t){var r=this.options.get("templateSelection");return this.options.get("escapeMarkup")(r(e,t))},n.prototype.selectionContainer=function(){return e("<span></span>")},n.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],r=this.$selection.find(".select2-selection__rendered"),i=this.display(t,r);r.empty().append(i),r.prop("title",t.title||t.text)},n}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,r){function i(e,t){i.__super__.constructor.apply(this,arguments)}return r.Extend(i,t),i.prototype.render=function(){var e=i.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},i.prototype.bind=function(t,r){var n=this;i.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){n.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(t){if(!n.options.get("disabled")){var r=e(this),i=r.parent(),s=i.data("data");n.trigger("unselect",{originalEvent:t,data:s})}})},i.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},i.prototype.display=function(e,t){var r=this.options.get("templateSelection");return this.options.get("escapeMarkup")(r(e,t))},i.prototype.selectionContainer=function(){return e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},i.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],i=0;i<e.length;i++){var n=e[i],s=this.selectionContainer(),a=this.display(n,s);s.append(a),s.prop("title",n.title||n.text),s.data("data",n),t.push(s)}var o=this.$selection.find(".select2-selection__rendered");r.appendMany(o,t)}},i}),t.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,r){this.placeholder=this.normalizePlaceholder(r.get("placeholder")),e.call(this,t,r)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var r=this.selectionContainer();return r.html(this.display(t)),r.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),r},t.prototype.update=function(e,t){var r=1==t.length&&t[0].id!=this.placeholder.id;if(t.length>1||r)return e.call(this,t);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},t}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function r(){}return r.prototype.bind=function(e,t,r){var i=this;e.call(this,t,r),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},r.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var r=this.$selection.find(".select2-selection__clear");if(0!==r.length){t.stopPropagation();for(var i=r.data("data"),n=0;n<i.length;n++){var s={data:i[n]};if(this.trigger("unselect",s),s.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},r.prototype._handleKeyboardClear=function(e,r,i){i.isOpen()||r.which!=t.DELETE&&r.which!=t.BACKSPACE||this._handleClear(r)},r.prototype.update=function(t,r){if(t.call(this,r),!(this.$selection.find(".select2-selection__placeholder").length>0||0===r.length)){var i=e('<span class="select2-selection__clear">&times;</span>');i.data("data",r),this.$selection.find(".select2-selection__rendered").prepend(i)}},r}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,r){function i(e,t,r){e.call(this,t,r)}return i.prototype.render=function(t){var r=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=r,this.$search=r.find("input");var i=t.call(this);return this._transferTabIndex(),i},i.prototype.bind=function(e,t,i){var n=this;e.call(this,t,i),t.on("open",function(){n.$search.trigger("focus")}),t.on("close",function(){n.$search.val(""),n.$search.removeAttr("aria-activedescendant"),n.$search.trigger("focus")}),t.on("enable",function(){n.$search.prop("disabled",!1),n._transferTabIndex()}),t.on("disable",function(){n.$search.prop("disabled",!0)}),t.on("focus",function(e){n.$search.trigger("focus")}),t.on("results:focus",function(e){n.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){n.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){n._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){if(e.stopPropagation(),n.trigger("keypress",e),n._keyUpPrevented=e.isDefaultPrevented(),e.which===r.BACKSPACE&&""===n.$search.val()){var t=n.$searchContainer.prev(".select2-selection__choice");if(t.length>0){var i=t.data("data");n.searchRemoveChoice(i),e.preventDefault()}}});var s=document.documentMode,a=s&&s<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){if(a)return void n.$selection.off("input.search input.searchcheck");n.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(a&&"input"===e.type)return void n.$selection.off("input.search input.searchcheck");var t=e.which;t!=r.SHIFT&&t!=r.CTRL&&t!=r.ALT&&t!=r.TAB&&n.handleSearch(e)})},i.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},i.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},i.prototype.update=function(e,t){var r=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),r&&this.$search.focus()},i.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},i.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},i.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{e=.75*(this.$search.val().length+1)+"em"}this.$search.css("width",e)},i}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,r,i){var n=this,s=["open","opening","close","closing","select","selecting","unselect","unselecting"],a=["opening","closing","selecting","unselecting"];t.call(this,r,i),r.on("*",function(t,r){if(-1!==e.inArray(t,s)){r=r||{};var i=e.Event("select2:"+t,{params:r});n.$element.trigger(i),-1!==e.inArray(t,a)&&(r.prevented=i.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function r(e){this.dict=e||{}}return r.prototype.all=function(){return this.dict},r.prototype.get=function(e){return this.dict[e]},r.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},r._cache={},r.loadPath=function(e){if(!(e in r._cache)){var i=t(e);r._cache[e]=i}return new r(r._cache[e])},r}),t.define("select2/diacritics",[],function(){return{"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}}),t.define("select2/data/base",["../utils"],function(e){function t(e,r){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,r){var i=t.id+"-result-";return i+=e.generateChars(4),null!=r.id?i+="-"+r.id.toString():i+="-"+e.generateChars(4),i},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,r){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,e),i.prototype.current=function(e){var t=[],i=this;this.$element.find(":selected").each(function(){var e=r(this),n=i.item(e);t.push(n)}),e(t)},i.prototype.select=function(e){var t=this;if(e.selected=!0,r(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(i){var n=[];e=[e],e.push.apply(e,i);for(var s=0;s<e.length;s++){var a=e[s].id;-1===r.inArray(a,n)&&n.push(a)}t.$element.val(n),t.$element.trigger("change")});else{var i=e.id;this.$element.val(i),this.$element.trigger("change")}},i.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple")){if(e.selected=!1,r(e.element).is("option"))return e.element.selected=!1,void this.$element.trigger("change");this.current(function(i){for(var n=[],s=0;s<i.length;s++){var a=i[s].id;a!==e.id&&-1===r.inArray(a,n)&&n.push(a)}t.$element.val(n),t.$element.trigger("change")})}},i.prototype.bind=function(e,t){var r=this;this.container=e,e.on("select",function(e){r.select(e.data)}),e.on("unselect",function(e){r.unselect(e.data)})},i.prototype.destroy=function(){this.$element.find("*").each(function(){r.removeData(this,"data")})},i.prototype.query=function(e,t){var i=[],n=this;this.$element.children().each(function(){var t=r(this);if(t.is("option")||t.is("optgroup")){var s=n.item(t),a=n.matches(e,s);null!==a&&i.push(a)}}),t({results:i})},i.prototype.addOptions=function(e){t.appendMany(this.$element,e)},i.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),void 0!==t.textContent?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var i=r(t),n=this._normalizeItem(e);return n.element=t,r.data(t,"data",n),i},i.prototype.item=function(e){var t={};if(null!=(t=r.data(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var i=e.children("option"),n=[],s=0;s<i.length;s++){var a=r(i[s]),o=this.item(a);n.push(o)}t.children=n}return t=this._normalizeItem(t),t.element=e[0],r.data(e[0],"data",t),t},i.prototype._normalizeItem=function(e){r.isPlainObject(e)||(e={id:e,text:e}),e=r.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),r.extend({},t,e)},i.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},i}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,r){function i(e,t){var r=t.get("data")||[];i.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(r))}return t.Extend(i,e),i.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,r){return r.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),i.__super__.select.call(this,e)},i.prototype.convertToOptions=function(e){for(var i=this,n=this.$element.find("option"),s=n.map(function(){return i.item(r(this)).id}).get(),a=[],o=0;o<e.length;o++){var l=this._normalizeItem(e[o]);if(r.inArray(l.id,s)>=0){var d=n.filter(function(e){return function(){return r(this).val()==e.id}}(l)),c=this.item(d),h=r.extend(!0,{},l,c),u=this.option(h);d.replaceWith(u)}else{var p=this.option(l);if(l.children){var f=this.convertToOptions(l.children);t.appendMany(p,f)}a.push(p)}}return a},i}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,r){function i(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),i.__super__.constructor.call(this,e,t)}return t.Extend(i,e),i.prototype._applyDefaults=function(e){var t={data:function(e){return r.extend({},e,{q:e.term})},transport:function(e,t,i){var n=r.ajax(e);return n.then(t),n.fail(i),n}};return r.extend({},t,e,!0)},i.prototype.processResults=function(e){return e},i.prototype.query=function(e,t){function i(){var i=s.transport(s,function(i){var s=n.processResults(i,e);n.options.get("debug")&&window.console&&console.error&&(s&&s.results&&r.isArray(s.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(s)},function(){i.status&&"0"===i.status||n.trigger("results:message",{message:"errorLoading"})});n._request=i}var n=this;null!=this._request&&(r.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var s=r.extend({type:"GET"},this.ajaxOptions);"function"==typeof s.url&&(s.url=s.url.call(this.$element,e)),"function"==typeof s.data&&(s.data=s.data.call(this.$element,e)),this.ajaxOptions.delay&&null!=e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(i,this.ajaxOptions.delay)):i()},i}),t.define("select2/data/tags",["jquery"],function(e){function t(t,r,i){var n=i.get("tags"),s=i.get("createTag");void 0!==s&&(this.createTag=s);var a=i.get("insertTag");if(void 0!==a&&(this.insertTag=a),t.call(this,r,i),e.isArray(n))for(var o=0;o<n.length;o++){var l=n[o],d=this._normalizeItem(l),c=this.option(d);this.$element.append(c)}}return t.prototype.query=function(e,t,r){function i(e,s){for(var a=e.results,o=0;o<a.length;o++){var l=a[o],d=null!=l.children&&!i({results:l.children},!0);if(l.text===t.term||d)return!s&&(e.data=a,void r(e))}if(s)return!0;var c=n.createTag(t);if(null!=c){var h=n.option(c);h.attr("data-select2-tag",!0),n.addOptions([h]),n.insertTag(a,c)}e.results=a,r(e)}var n=this;if(this._removeOldTags(),null==t.term||null!=t.page)return void e.call(this,t,r);e.call(this,t,i)},t.prototype.createTag=function(t,r){var i=e.trim(r.term);return""===i?null:{id:i,text:i}},t.prototype.insertTag=function(e,t,r){t.unshift(r)},t.prototype._removeOldTags=function(t){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,r){var i=r.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,r)}return t.prototype.bind=function(e,t,r){e.call(this,t,r),this.$search=t.dropdown.$search||t.selection.$search||r.find(".select2-search__field")},t.prototype.query=function(t,r,i){function n(t){var r=a._normalizeItem(t);if(!a.$element.find("option").filter(function(){return e(this).val()===r.id}).length){var i=a.option(r);i.attr("data-select2-tag",!0),a._removeOldTags(),a.addOptions([i])}s(r)}function s(e){a.trigger("select",{data:e})}var a=this;r.term=r.term||"";var o=this.tokenizer(r,this.options,n);o.term!==r.term&&(this.$search.length&&(this.$search.val(o.term),this.$search.focus()),r.term=o.term),t.call(this,r,i)},t.prototype.tokenizer=function(t,r,i,n){for(var s=i.get("tokenSeparators")||[],a=r.term,o=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};o<a.length;){var d=a[o];if(-1!==e.inArray(d,s)){var c=a.substr(0,o),h=e.extend({},r,{term:c}),u=l(h);null!=u?(n(u),a=a.substr(o+1)||"",o=0):o++}else o++}return{term:a}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,r){this.minimumInputLength=r.get("minimumInputLength"),e.call(this,t,r)}return e.prototype.query=function(e,t,r){if(t.term=t.term||"",t.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});e.call(this,t,r)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,r){this.maximumInputLength=r.get("maximumInputLength"),e.call(this,t,r)}return e.prototype.query=function(e,t,r){if(t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});e.call(this,t,r)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,r){this.maximumSelectionLength=r.get("maximumSelectionLength"),e.call(this,t,r)}return e.prototype.query=function(e,t,r){var i=this;this.current(function(n){var s=null!=n?n.length:0;if(i.maximumSelectionLength>0&&s>=i.maximumSelectionLength)return void i.trigger("results:message",{message:"maximumSelected",args:{maximum:i.maximumSelectionLength}});e.call(i,t,r)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function r(e,t){this.$element=e,this.options=t,r.__super__.constructor.call(this)}return t.Extend(r,t.Observable),r.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},r.prototype.bind=function(){},r.prototype.position=function(e,t){},r.prototype.destroy=function(){this.$dropdown.remove()},r}),t.define("select2/dropdown/search",["jquery","../utils"],function(e,t){function r(){}return r.prototype.render=function(t){var r=t.call(this),i=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=i,this.$search=i.find("input"),r.prepend(i),r},r.prototype.bind=function(t,r,i){var n=this;t.call(this,r,i),this.$search.on("keydown",function(e){n.trigger("keypress",e),n._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(t){e(this).off("keyup")}),this.$search.on("keyup input",function(e){n.handleSearch(e)}),r.on("open",function(){n.$search.attr("tabindex",0),n.$search.focus(),window.setTimeout(function(){n.$search.focus()},0)}),r.on("close",function(){n.$search.attr("tabindex",-1),n.$search.val("")}),r.on("focus",function(){r.isOpen()&&n.$search.focus()}),r.on("results:all",function(e){if(null==e.query.term||""===e.query.term){n.showSearch(e)?n.$searchContainer.removeClass("select2-search--hide"):n.$searchContainer.addClass("select2-search--hide")}})},r.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},r.prototype.showSearch=function(e,t){return!0},r}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,r,i){this.placeholder=this.normalizePlaceholder(r.get("placeholder")),e.call(this,t,r,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var r=t.slice(0),i=t.length-1;i>=0;i--){var n=t[i];this.placeholder.id===n.id&&r.splice(i,1)}return r},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,r,i){this.lastParams={},e.call(this,t,r,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,r,i){var n=this;t.call(this,r,i),r.on("query",function(e){n.lastParams=e,n.loading=!0}),r.on("query:append",function(e){n.lastParams=e,n.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,n.$loadingMore[0]);if(!n.loading&&t){n.$results.offset().top+n.$results.outerHeight(!1)+50>=n.$loadingMore.offset().top+n.$loadingMore.outerHeight(!1)&&n.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),r=this.options.get("translations").get("loadingMore");return t.html(r(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function r(t,r,i){this.$dropdownParent=i.get("dropdownParent")||e(document.body),t.call(this,r,i)}return r.prototype.bind=function(e,t,r){var i=this,n=!1;e.call(this,t,r),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),n||(n=!0,t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}))}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},r.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},r.prototype.position=function(e,t,r){t.attr("class",r.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=r},r.prototype.render=function(t){var r=e("<span></span>"),i=t.call(this);return r.append(i),this.$dropdownContainer=r,r},r.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},r.prototype._attachPositioningHandler=function(r,i){var n=this,s="scroll.select2."+i.id,a="resize.select2."+i.id,o="orientationchange.select2."+i.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(s,function(t){var r=e(this).data("select2-scroll-position");e(this).scrollTop(r.y)}),e(window).on(s+" "+a+" "+o,function(e){n._positionDropdown(),n._resizeDropdown()})},r.prototype._detachPositioningHandler=function(r,i){var n="scroll.select2."+i.id,s="resize.select2."+i.id,a="orientationchange.select2."+i.id;this.$container.parents().filter(t.hasScroll).off(n),e(window).off(n+" "+s+" "+a)},r.prototype._positionDropdown=function(){var t=e(window),r=this.$dropdown.hasClass("select2-dropdown--above"),i=this.$dropdown.hasClass("select2-dropdown--below"),n=null,s=this.$container.offset();s.bottom=s.top+this.$container.outerHeight(!1);var a={height:this.$container.outerHeight(!1)};a.top=s.top,a.bottom=s.top+a.height;var o={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},d=l.top<s.top-o.height,c=l.bottom>s.bottom+o.height,h={left:s.left,top:a.bottom},u=this.$dropdownParent;"static"===u.css("position")&&(u=u.offsetParent());var p=u.offset();h.top-=p.top,h.left-=p.left,r||i||(n="below"),c||!d||r?!d&&c&&r&&(n="below"):n="above",("above"==n||r&&"below"!==n)&&(h.top=a.top-p.top-o.height),null!=n&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+n),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+n)),this.$dropdownContainer.css(h)},r.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},r.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},r}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var r=0,i=0;i<t.length;i++){var n=t[i];n.children?r+=e(n.children):r++}return r}function t(e,t,r,i){this.minimumResultsForSearch=r.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,r,i)}return t.prototype.showSearch=function(t,r){return!(e(r.data.results)<this.minimumResultsForSearch)&&t.call(this,r)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,r){var i=this;e.call(this,t,r),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var r=t.originalSelect2Event;if("select"===r._type||"unselect"===r._type)return}var i=this.getHighlightedResults();if(!(i.length<1)){var n=i.data("data");null!=n.element&&n.element.selected||null==n.element&&n.selected||this.trigger("select",{data:n})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,r){var i=this;e.call(this,t,r),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var r=t.originalEvent;r&&r.ctrlKey||this.trigger("close",{originalEvent:r,originalSelect2Event:t})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,r="Please delete "+t+" character";return 1!=t&&(r+="s"),r},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,r,i,n,s,a,o,l,d,c,h,u,p,f,_,g,m,v,y,j,b,x,w,k,C,A,$,T){function E(){this.reset()}return E.prototype.apply=function(h){if(h=e.extend(!0,{},this.defaults,h),null==h.dataAdapter){if(null!=h.ajax?h.dataAdapter=f:null!=h.data?h.dataAdapter=p:h.dataAdapter=u,h.minimumInputLength>0&&(h.dataAdapter=d.Decorate(h.dataAdapter,m)),h.maximumInputLength>0&&(h.dataAdapter=d.Decorate(h.dataAdapter,v)),h.maximumSelectionLength>0&&(h.dataAdapter=d.Decorate(h.dataAdapter,y)),h.tags&&(h.dataAdapter=d.Decorate(h.dataAdapter,_)),null==h.tokenSeparators&&null==h.tokenizer||(h.dataAdapter=d.Decorate(h.dataAdapter,g)),null!=h.query){var T=t(h.amdBase+"compat/query");h.dataAdapter=d.Decorate(h.dataAdapter,T)}if(null!=h.initSelection){var E=t(h.amdBase+"compat/initSelection");h.dataAdapter=d.Decorate(h.dataAdapter,E)}}if(null==h.resultsAdapter&&(h.resultsAdapter=r,null!=h.ajax&&(h.resultsAdapter=d.Decorate(h.resultsAdapter,w)),null!=h.placeholder&&(h.resultsAdapter=d.Decorate(h.resultsAdapter,x)),h.selectOnClose&&(h.resultsAdapter=d.Decorate(h.resultsAdapter,A))),null==h.dropdownAdapter){if(h.multiple)h.dropdownAdapter=j;else{var O=d.Decorate(j,b);h.dropdownAdapter=O}if(0!==h.minimumResultsForSearch&&(h.dropdownAdapter=d.Decorate(h.dropdownAdapter,C)),h.closeOnSelect&&(h.dropdownAdapter=d.Decorate(h.dropdownAdapter,$)),null!=h.dropdownCssClass||null!=h.dropdownCss||null!=h.adaptDropdownCssClass){var S=t(h.amdBase+"compat/dropdownCss");h.dropdownAdapter=d.Decorate(h.dropdownAdapter,S)}h.dropdownAdapter=d.Decorate(h.dropdownAdapter,k)}if(null==h.selectionAdapter){if(h.multiple?h.selectionAdapter=n:h.selectionAdapter=i,null!=h.placeholder&&(h.selectionAdapter=d.Decorate(h.selectionAdapter,s)),h.allowClear&&(h.selectionAdapter=d.Decorate(h.selectionAdapter,a)),h.multiple&&(h.selectionAdapter=d.Decorate(h.selectionAdapter,o)),null!=h.containerCssClass||null!=h.containerCss||null!=h.adaptContainerCssClass){var N=t(h.amdBase+"compat/containerCss");h.selectionAdapter=d.Decorate(h.selectionAdapter,N)}h.selectionAdapter=d.Decorate(h.selectionAdapter,l)}if("string"==typeof h.language)if(h.language.indexOf("-")>0){var P=h.language.split("-"),D=P[0];h.language=[h.language,D]}else h.language=[h.language];if(e.isArray(h.language)){var L=new c;h.language.push("en");for(var q=h.language,M=0;M<q.length;M++){var I=q[M],z={};try{z=c.loadPath(I)}catch(e){try{I=this.defaults.amdLanguageBase+I,z=c.loadPath(I)}catch(e){h.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+I+'" could not be automatically loaded. A fallback will be used instead.');continue}}L.extend(z)}h.translations=L}else{var H=c.loadPath(this.defaults.amdLanguageBase+"en"),K=new c(h.language);K.extend(H),h.translations=K}return h},E.prototype.reset=function(){function t(e){function t(e){return h[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function r(i,n){if(""===e.trim(i.term))return n;if(n.children&&n.children.length>0){for(var s=e.extend(!0,{},n),a=n.children.length-1;a>=0;a--){null==r(i,n.children[a])&&s.children.splice(a,1)}return s.children.length>0?s:r(i,s)}var o=t(n.text).toUpperCase(),l=t(i.term).toUpperCase();return o.indexOf(l)>-1?n:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:d.escapeMarkup,language:T,matcher:r,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},E.prototype.set=function(t,r){var i=e.camelCase(t),n={};n[i]=r;var s=d._convertData(n);e.extend(this.defaults,s)},new E}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,r,i){function n(t,n){if(this.options=t,null!=n&&this.fromElement(n),this.options=r.apply(this.options),n&&n.is("input")){var s=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=i.Decorate(this.options.dataAdapter,s)}}return n.prototype.fromElement=function(e){var r=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var n={};n=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset,e.data()):e.data();var s=t.extend(!0,{},n);s=i._convertData(s);for(var a in s)t.inArray(a,r)>-1||(t.isPlainObject(this.options[a])?t.extend(this.options[a],s[a]):this.options[a]=s[a]);return this},n.prototype.get=function(e){return this.options[e]},n.prototype.set=function(e,t){this.options[e]=t},n}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,r,i){var n=function e(r,i){null!=r.data("select2")&&r.data("select2").destroy(),this.$element=r,this.id=this._generateId(r),i=i||{},this.options=new t(i,r),e.__super__.constructor.call(this);var n=r.attr("tabindex")||0;r.data("old-tabindex",n),r.attr("tabindex","-1");var s=this.options.get("dataAdapter");this.dataAdapter=new s(r,this.options);var a=this.render();this._placeContainer(a);var o=this.options.get("selectionAdapter");this.selection=new o(r,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,a);var l=this.options.get("dropdownAdapter");this.dropdown=new l(r,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,a);var d=this.options.get("resultsAdapter");this.results=new d(r,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var c=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){c.trigger("selection:update",{data:e})}),r.addClass("select2-hidden-accessible"),r.attr("aria-hidden","true"),this._syncAttributes(),r.data("select2",this)};return r.Extend(n,r.Observable),n.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+r.generateChars(2):r.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),t="select2-"+t},n.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},n.prototype._resolveWidth=function(e,t){if("resolve"==t){var r=this._resolveWidth(e,"style");return null!=r?r:this._resolveWidth(e,"element")}if("element"==t){var i=e.outerWidth(!1);return i<=0?"auto":i+"px"}if("style"==t){var n=e.attr("style");if("string"!=typeof n)return null;for(var s=n.split(";"),a=0,o=s.length;a<o;a+=1){var l=s[a].replace(/\s/g,""),d=l.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(null!==d&&d.length>=1)return d[1]}return null}return t},n.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},n.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=r.bind(this._syncAttributes,this),this._syncS=r.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=i?(this._observer=new i(function(r){e.each(r,t._syncA),e.each(r,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},n.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,r){e.trigger(t,r)})},n.prototype._registerSelectionEvents=function(){var t=this,r=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(i,n){-1===e.inArray(i,r)&&t.trigger(i,n)})},n.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,r){e.trigger(t,r)})},n.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,r){e.trigger(t,r)})},n.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(r){e.trigger("results:all",{data:r,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(r){e.trigger("results:append",{data:r,query:t})})}),this.on("keypress",function(t){var r=t.which;e.isOpen()?r===i.ESC||r===i.TAB||r===i.UP&&t.altKey?(e.close(),t.preventDefault()):r===i.ENTER?(e.trigger("results:select",{}),t.preventDefault()):r===i.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):r===i.UP?(e.trigger("results:previous",{}),t.preventDefault()):r===i.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(r===i.ENTER||r===i.SPACE||r===i.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},n.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},n.prototype._syncSubtree=function(e,t){var r=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&t.addedNodes.length>0)for(var n=0;n<t.addedNodes.length;n++){var s=t.addedNodes[n];s.selected&&(r=!0)}else t.removedNodes&&t.removedNodes.length>0&&(r=!0);else r=!0;r&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}},n.prototype.trigger=function(e,t){var r=n.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in i){var s=i[e],a={prevented:!1,name:e,args:t};if(r.call(this,s,a),a.prevented)return void(t.prevented=!0)}r.call(this,e,t)},n.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},n.prototype.open=function(){this.isOpen()||this.trigger("query",{})},n.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},n.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},n.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},n.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},n.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},n.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){e=t}),e},n.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var r=t[0];e.isArray(r)&&(r=e.map(r,function(e){return e.toString()})),this.$element.val(r).trigger("change")},n.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},n.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},n}),t.define("jquery-mousewheel",["jquery"],function(e){return e}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,r,i){if(null==e.fn.select2){var n=["open","close","destroy"];e.fn.select2=function(t){if(t=t||{},"object"===(void 0===t?"undefined":o(t)))return this.each(function(){var i=e.extend(!0,{},t);new r(e(this),i)}),this;if("string"==typeof t){var i,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e(this).data("select2");null==r&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),i=r[t].apply(r,s)}),e.inArray(t,n)>-1?this:i}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=i),r}),{define:t.define,require:t.require}}(),r=t.require("jquery.select2");return e.fn.select2.amd=t,r})}).call(t,r(1))},function(e,t,r){"use strict";function i(e){var t=e instanceof Date?e:new Date(e);return t.getDate()||(t=new Date),t}function n(e,t){var r=i(e),n=void 0,s=void 0,a=0;for(t=t||"YYYY-MM-DD HH:mm:ss",n=r.getHours(),s=[["M+",r.getMonth()+1],["D+",r.getDate()],["H+",n],["h+",n>12?n-12:n],["m+",r.getMinutes()],["s+",r.getSeconds()]],/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(r.getFullYear()+"").substr(4-RegExp.$1.length)));a<s.length;a++)new RegExp("("+s[a][0]+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?s[a][1]:("00"+s[a][1]).substr((""+s[a][1]).length)));return t.replace(/a/gi,n>11?"pm":"am")}function s(e){var t=void 0,r=void 0;t="string"==typeof e?"zh-cn"===e?l:o:e,d||(d={});for(r in t)t.hasOwnProperty(r)&&"string"==typeof t[r]&&(d[r]=t[r])}function a(e){d||s("");var t=+new Date-+i(e),r=void 0,n=void 0,a=0,o=void 0,l=void 0;for(t<0?(r=d.future,t=-t):r=d.past;a<c.length;a++)if(o=c[a],l=o[1],t>=l){n=d[o[0]].replace("%s",parseInt(t/l,0)||1);break}return r.replace("%s",n)}var o={future:"in %s",past:"%s ago",s:"a few seconds",mm:"%s minutes",hh:"%s hours",dd:"%s days",MM:"%s months",yy:"%s years"},l={future:"%s",past:"%s",s:"",mm:"%s",hh:"%s",dd:"%s",MM:"%s",yy:"%s"},d=void 0,c=[["yy",31536e6],["MM",2592e6],["dd",864e5],["hh",36e5],["mm",6e4],["s",0]];t.format=n,t.locate=s,t.fromNow=a},function(e,t){},function(e,t){},function(e,t,r){e.exports=r(0)(78)},function(e,t,r){e.exports=r(0)(79)},function(e,t,r){e.exports=r(0)(80)},function(e,t,r){e.exports=r(0)(81)},function(e,t,r){"use strict";var i=r(12),n=r(11),s=r(1),a=r(3),o=r(2),l=r(6);r(9),r(10),r(4),r(7),r(5),r(8);var d=i.createClass({displayName:"Header",render:function(){return i.createElement("div",{className:"container mb-3"},i.createElement("nav",{className:"navbar navbar-toggleable-md navbar-light bg-faded"},i.createElement("a",{className:"navbar-brand",href:"/"},"Canvas File Sync"),i.createElement("div",{className:"collapse navbar-collapse"},i.createElement("ul",{className:"navbar-nav mr-auto"}),i.createElement("ul",{className:"navbar-nav"},i.createElement("li",{className:"nav-item"},i.createElement("a",{className:"nav-link",href:"/auth"},"Grant Privilege"))))))}}),c=i.createClass({displayName:"CourseSelect",render:function(){return i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",ref:"select"},i.createElement("option",null)))},componentDidMount:function(){var e=this;s(this.refs.select).select2({data:this.props.courses,placeholder:"Please select a course",allowClear:!0}).on("select2:select",function(t){e.props.callbackChangeCourse(t.params.data.id)})},componentDidUpdate:function(){var e=[];this.props.courses.map(function(t){var r=t.course_code;t.course_code!==t.name&&(r+=" "+t.name),e.push({id:t.id,text:r})}),s(this.refs.select).select2({data:e,placeholder:"Please select a course",allowClear:!0})}}),h=i.createClass({displayName:"FileTree",getDefaultProps:function(){return{fileTree:{}}},shouldComponentUpdate:function(e,t){return this.props.fileTree.id!==e.fileTree.id},render:function(){return i.createElement("div",{ref:"fileTree"})},componentDidMount:function(){var e=this;s(this.refs.fileTree).jstree({core:{data:function(t,r){r(e.props.fileTree)},worker:!1}}).on("select_node.jstree",function(t,r){e.props.callbackChangeFolder(r.node.id)}),console.log("Tree init")},componentDidUpdate:function(){s(this.refs.fileTree).jstree(!0).refresh(),s(this.refs.fileTree).jstree(!0).select_node(2),console.log("Tree update")}}),u=i.createClass({displayName:"File",render:function(){return i.createElement("tr",null,i.createElement("td",null,i.createElement("i",{className:"fa fa-fw "+this.props.file.icon,"aria-hidden":"true"}),"",i.createElement("a",{href:this.props.file.url},this.props.file.display_name)),i.createElement("td",null,this.props.file.created_at),i.createElement("td",null,this.props.file.updated_at),i.createElement("td",{className:"text-right"},this.props.file.size))}}),p=i.createClass({displayName:"Folder",onClick:function(){this.props.callbackChangeFolder(this.props.folder.id)},render:function(){return this.props.parent?i.createElement("tr",null,i.createElement("td",null,i.createElement("i",{className:"fa fa-fw fa-folder-open-o","aria-hidden":"true"}),"",i.createElement("a",{href:"javascript:void(0);",onClick:this.onClick},".."))):i.createElement("tr",null,i.createElement("td",null,i.createElement("i",{className:"fa fa-fw fa-folder-o","aria-hidden":"true"}),"",i.createElement("a",{href:"javascript:void(0);",onClick:this.onClick},this.props.folder.name)),i.createElement("td",null,this.props.folder.created_at),i.createElement("td",null,this.props.folder.updated_at))}}),f=i.createClass({displayName:"FileList",render:function(){var e=this;return i.createElement("table",{className:"table"},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Name"),i.createElement("th",null,"Time Created"),i.createElement("th",null,"Time Updated"),i.createElement("th",{className:"text-right"},"Size"))),i.createElement("tbody",null,this.props.parentFolder.id?i.createElement(p,{callbackChangeFolder:this.props.callbackChangeFolder,folder:this.props.parentFolder,parent:!0}):"",this.props.folder.children?this.props.folder.children.map(function(t){return i.createElement(p,{callbackChangeFolder:e.props.callbackChangeFolder,folder:t})}):"",this.props.folder.files?this.props.folder.files.map(function(e){return i.createElement(u,{file:e})}):""))}}),_=i.createClass({displayName:"FileView",getDefaultProps:function(){return{courses:["Course 1","Course 2"],fileTree:{text:"",children:[],files:[]}}},getInitialState:function(){return{files:[],folders:[],course:{sync_time:null},processing:!1,error:!1,first:!0}},processData:function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm";return l.format(new Date(e),t)},r=this.props.fileTree,i={};return e.folders.map(function(e){i.hasOwnProperty(e.id)||(i[e.id]={children:[]}),e.created_at=t(e.created_at),e.updated_at=t(e.updated_at),s.extend(i[e.id],e),i[e.id].text=e.name,i[e.id].files=[],i[e.id].__children=i[e.id].children,e.parent_folder_id?(i.hasOwnProperty(e.parent_folder_id)||(i[e.parent_folder_id]={children:[]}),i[e.parent_folder_id].children.push(i[e.id])):r=i[e.id]}),e.files.map(function(r){r.url=e.download_host+r.filename+"?attname="+r.display_name,r.size=a(r.size),r.icon=o.processFile(r.filename),r.created_at=t(r.created_at),r.updated_at=t(r.updated_at),i.hasOwnProperty(r.folder_id)&&i[r.folder_id].files.push(r)}),r.text=e.course.name,r.state={opened:!0},e.course.last_sync_time=e.course.sync_time,e.course.sync_time=t(e.course.sync_time,"YYYY-MM-DD HH:mm:ss"),console.log(r),s.extend({fileTree:r,folderMap:i,currentFolderId:r.id,sync:!1,sync_timeout:!1,error:!1,first:!1},e)},callbackChangeFolder:function(e){if(!this.processing&&(e=parseInt(e))&&this.state.currentFolderId!==e&&this.state.folderMap.hasOwnProperty(e)){this.processing=!0;var t=this.refs.fileTree,r=s(t.refs.fileTree).jstree(!0);r.deselect_all(),r.select_node(e),r.open_node(e),this.setState({currentFolderId:e}),this.processing=!1}},callbackChangeCourse:function(e){e!==this.state.course.id&&(this.processing=!1,this.refreshTree(e))},onSyncClick:function(){var e=this;this.setState({sync:!0});var t=this.timestamp=new Date,r=0,i=setInterval(function(){return t!==e.timestamp?void window.clearInterval(i):30==++r?(window.clearInterval(i),void e.setState({sync:!1,sync_timeout:!0})):void s.ajax({url:"/data/sync",data:{id:e.state.course.id,time:Date.parse(e.state.course.last_sync_time)},type:"GET",dataType:"json",success:function(r){if(t!==e.timestamp)return void window.clearInterval(i);(0!=r.state||e.state.sync)&&1==r.state&&(e.refreshTree(e.state.course.id,!0),window.clearInterval(i))}})},2e3)},componentWillUpdate:function(){for(var e in this.state.folderMap)this.state.folderMap[e].children=this.state.folderMap[e].__children},render:function(){var e=void 0,t={};this.state.currentFolderId?(e=this.state.folderMap[this.state.currentFolderId],e.parent_folder_id&&(t=this.state.folderMap[e.parent_folder_id])):e=this.props.fileTree;var r=[i.createElement("div",{className:"jumbotron"},i.createElement("h1",{className:"display-3"},"Canvas File Sync"),i.createElement("p",{className:"lead"},"Canvas File Sync is created by tc-imba, in order to sync all files on Canvas LMS with the help of access token providers."),i.createElement("hr",{className:"my-4"}),i.createElement("p",null,"If you'd like to contribute, grant privilege to us in the button below."),i.createElement("p",{className:"lead"},i.createElement("a",{className:"btn btn-primary btn-lg",href:"/auth",role:"button"},"Grant Privilege")))],n=[i.createElement("div",{className:"mb-3"},i.createElement("span",null,"Last Sync Time: ",this.state.course.sync_time||"Unknown",""),"(Thanks to the data provided by ",this.state.course.sync_user_name,")",i.createElement("span",{className:"float-right"},i.createElement("a",{onClick:this.onSyncClick},i.createElement("i",{className:"fa fa-refresh "+(this.state.sync?"fa-spin":"")})),"",this.state.sync?"Syncing":this.state.sync_timeout?"Sync timeout":this.state.sync_success?"Synced":"Sync now")),i.createElement(f,{callbackChangeFolder:this.callbackChangeFolder,folder:e,parentFolder:t})],s=[i.createElement("h4",null,"Sorry, we currently haven't data for the course"),i.createElement("div",null,"Error: ",this.state.error)];return i.createElement("div",{className:"row"},i.createElement("div",{className:"col-sm-3"},i.createElement(c,{courses:this.props.courses,callbackChangeCourse:this.callbackChangeCourse}),this.state.error||this.state.first?"":i.createElement(h,{callbackChangeFolder:this.callbackChangeFolder,fileTree:this.state.fileTree,ref:"fileTree"})),i.createElement("div",{className:"col-sm-9"},this.state.error?s:this.state.first?r:n))},refreshTree:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=function(e){t.setState({error:JSON.stringify(e,null,"    ")})};s.ajax({url:"/data/course",data:{id:e},type:"GET",dataType:"json",success:function(e){e.course?(e=t.processData(e),r&&(e.sync_success=!0),t.setState(e),e.sync&&t.onSyncClick()):i(e),console.log(e)},error:i})},componentDidMount:function(){},componentDidUpdate:function(){}}),g=i.createClass({displayName:"App",getInitialState:function(){return{courses:[]}},render:function(){return i.createElement("div",{className:"app"},i.createElement(d,null),",",i.createElement("div",{className:"app-body container"},i.createElement(_,{courses:this.state.courses})))},componentDidMount:function(){var e=this;s.ajax({url:"/public/courses.json",type:"GET",dataType:"json",success:function(t){console.log(t),e.setState({courses:t})}})}});n.render(i.createElement(g,null),document.getElementById("body"))},function(e,t,r){"use strict";var i,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(i=window)}e.exports=i}]);